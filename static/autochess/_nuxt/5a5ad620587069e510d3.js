(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{150:function(e,t,n){var content=n(165);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(53).default)("01c01b68",content,!0,{sourceMap:!1})},151:function(e,t,n){var content=n(167);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(53).default)("b7320a56",content,!0,{sourceMap:!1})},152:function(e,t,n){var content=n(171);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(53).default)("79fd60aa",content,!0,{sourceMap:!1})},154:function(e,t,n){var content=n(177);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(53).default)("6201b52f",content,!0,{sourceMap:!1})},155:function(e,t,n){var content=n(179);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(53).default)("0b8fe52d",content,!0,{sourceMap:!1})},156:function(e,t,n){var content=n(181);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(53).default)("09f2722b",content,!0,{sourceMap:!1})},157:function(e,t,n){var content=n(183);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(53).default)("0e4392af",content,!0,{sourceMap:!1})},158:function(e,t,n){var content=n(185);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(53).default)("21a04976",content,!0,{sourceMap:!1})},164:function(e,t,n){"use strict";var r=n(150);n.n(r).a},165:function(e,t,n){(e.exports=n(52)(!1)).push([e.i,".piece[data-v-fc4c75e4]{--endspeed:0.3s;--startspeed:0.15s;position:relative;z-index:1;display:flex;align-items:center;justify-content:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.piece[data-v-fc4c75e4],.piece div[data-v-fc4c75e4]{width:100%;height:100%}.piece .pieceicon[data-v-fc4c75e4]{display:flex;align-items:center;justify-content:center;background-size:contain;background-repeat:no-repeat;transition:transform var(--endspeed),opacity var(--endspeed);z-index:3}.piece .piecebg[data-v-fc4c75e4]{position:absolute;top:0;left:0;transform:scale(1);background:transparent;box-shadow:none;transition:box-shadow var(--endspeed),transform var(--endspeed),opacity var(--endspeed),background var(--endspeed);z-index:2}.piece.pawn .pieceicon[data-v-fc4c75e4]{opacity:.75;width:75%;height:75%}.piece.bishop .pieceicon[data-v-fc4c75e4],.piece.knight .pieceicon[data-v-fc4c75e4],.piece.rook .pieceicon[data-v-fc4c75e4]{width:85%;height:85%}.piece.king .pieceicon[data-v-fc4c75e4]{border:4px solid var(--highlight)}.moving[data-v-fc4c75e4]{z-index:2}.moving .piecebg[data-v-fc4c75e4]{background:var(--bg-overlay);box-shadow:0 3px 12px var(--bg-shade3)}.moving .piecebg[data-v-fc4c75e4],.moving .pieceicon[data-v-fc4c75e4]{transition:background var(--startspeed),box-shadow var(--startspeed),transform var(--startspeed),opacity var(--startspeed);transform:scale(1.3)}.moving .pieceicon[data-v-fc4c75e4]{opacity:1!important}.damage .piecebg[data-v-fc4c75e4]{background:var(--damage-fade)!important}",""])},166:function(e,t,n){"use strict";var r=n(151);n.n(r).a},167:function(e,t,n){(e.exports=n(52)(!1)).push([e.i,".movable[data-v-082886f6]{cursor:move;position:absolute;transition:transform .2s,background .2s,box-shadow .2s}.dragging[data-v-082886f6]{position:absolute;z-index:5;transform:scale(1.3);box-shadow:0 10px 10px var(--bg-shade3);background:var(--bg-overlay)}",""])},170:function(e,t,n){"use strict";var r=n(152);n.n(r).a},171:function(e,t,n){(e.exports=n(52)(!1)).push([e.i,".stats[data-v-e2f59a0c]{width:100px}.stats .listing[data-v-e2f59a0c]{display:flex;align-items:center}.stats .piece[data-v-e2f59a0c]{display:inline-block;height:30px;width:30px;margin-right:10px}.grid-move[data-v-e2f59a0c]{transition:transform .4s cubic-bezier(.175,.885,.32,1.275);z-index:2}.grid-enter-active[data-v-e2f59a0c],.grid-leave-active[data-v-e2f59a0c]{transition:all .2s cubic-bezier(.175,.885,.32,1.275)}.grid-enter[data-v-e2f59a0c],.grid-leave-to[data-v-e2f59a0c]{opacity:0;transform:translateY(10px)}",""])},176:function(e,t,n){"use strict";var r=n(154);n.n(r).a},177:function(e,t,n){(e.exports=n(52)(!1)).push([e.i,".gameview[data-v-331ffc42],.gameview .board[data-v-331ffc42]{position:relative}.gameview .board[data-v-331ffc42]{display:grid;z-index:1;transition:background .2s;background:var(--bg-shade)}.gameview .board.dropzone[data-v-331ffc42]{background:linear-gradient(180deg,var(--bg-fade) 50%,var(--highlight-light) 0)}.gameview .board.outlines[data-v-331ffc42]{background:none;position:absolute;pointer-events:none;z-index:0;border:none}.gameview .board.outlines div[data-v-331ffc42]{border:1px solid var(--bg-shade)}.gameview .board.outlines div.shade[data-v-331ffc42]{background:var(--bg-shade2)}.bench[data-v-331ffc42]{margin-top:10px;position:relative;display:grid;z-index:1;transition:background .2s;background:var(--bg-shade)}.bench.dropzone[data-v-331ffc42]{background:var(--highlight-light)}.statspane[data-v-331ffc42]{position:absolute;top:0;left:110%}.nointeract[data-v-331ffc42]{pointer-events:none;opacity:.6}.eventpopover[data-v-331ffc42]{font-size:1.4em;font-weight:800;color:var(--damage);z-index:3;-webkit-animation-name:fadeup-data-v-331ffc42;animation-name:fadeup-data-v-331ffc42;-webkit-animation-duration:1s;animation-duration:1s}.eventpopover[data-v-331ffc42],.winbanner[data-v-331ffc42]{position:absolute;transform:translateX(-50%) translateY(-50%)}.winbanner[data-v-331ffc42]{text-align:center;font-size:1.5rem;top:43%;left:50%;background:hsla(0,0%,100%,.95);padding:20px 30px;z-index:5;min-width:85%;transition:all .2s}.winbanner.fade[data-v-331ffc42]{opacity:.3}.scrubber[data-v-331ffc42]{padding:15px 0;width:100%}@-webkit-keyframes fadeup-data-v-331ffc42{0%{transform:translateX(-50%) translateY(-50%)}to{transform:translateX(-50%) translateY(-350%);opacity:0}}@keyframes fadeup-data-v-331ffc42{0%{transform:translateX(-50%) translateY(-50%)}to{transform:translateX(-50%) translateY(-350%);opacity:0}}.grid-move[data-v-331ffc42]{transition:transform .4s cubic-bezier(.175,.885,.32,1.275);z-index:2}.grid-leave-active[data-v-331ffc42]{display:none}",""])},178:function(e,t,n){"use strict";var r=n(155);n.n(r).a},179:function(e,t,n){(e.exports=n(52)(!1)).push([e.i,".gameoverview[data-v-d176d6ea]{position:relative;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center}.sectionlabel[data-v-d176d6ea],button[data-v-d176d6ea]{margin-top:20px}.score[data-v-d176d6ea]{width:100%;display:grid;grid-template-columns:50% 50%;grid-gap:10px}.score.highlight[data-v-d176d6ea]{background:var(--highlight-light)}",""])},180:function(e,t,n){"use strict";var r=n(156);n.n(r).a},181:function(e,t,n){(e.exports=n(52)(!1)).push([e.i,'.icon[data-v-54c30c0f]{position:relative;width:30px;height:30px;z-index:1;display:inline-flex;align-items:center;justify-content:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.icon[data-v-54c30c0f]:after{font-size:1.1rem;content:"";position:absolute;top:0;left:0;right:0;bottom:0;text-align:center;left:20%;top:10%}.icon.hp[data-v-54c30c0f]:after{content:"ðŸ’›"}.icon.gold[data-v-54c30c0f]:after{font-size:1.2rem;content:"ðŸ’°"}',""])},182:function(e,t,n){"use strict";var r=n(157);n.n(r).a},183:function(e,t,n){(e.exports=n(52)(!1)).push([e.i,".shopholder[data-v-de076518]{position:relative}.shop[data-v-de076518]{display:flex;align-items:center}.shop[data-v-de076518]>:not(:last-child){margin-right:15px}.shop .shopitem[data-v-de076518]{flex:1;cursor:pointer;position:relative;width:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;transition:all .2s}.shop .shopitem[data-v-de076518]:hover{background:#eee}.shop .shopitem.fade[data-v-de076518]{opacity:.3}.shop .piece[data-v-de076518]{width:30px;height:30px}",""])},184:function(e,t,n){"use strict";var r=n(158);n.n(r).a},185:function(e,t,n){(e.exports=n(52)(!1)).push([e.i,"main[data-v-373ce9fe]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;height:100%;margin:0 auto;flex-direction:column;justify-content:center}.topbar[data-v-373ce9fe],main[data-v-373ce9fe]{position:relative;display:flex;align-items:center}.topbar[data-v-373ce9fe]{width:100%;height:25px;justify-content:space-between;z-index:2}.tallbutton[data-v-373ce9fe]{position:relative;top:12px;padding:16px 20px}.hidden[data-v-373ce9fe]{width:0;height:0;opacity:0;pointer-events:none}.playerstats[data-v-373ce9fe]{width:100%;height:20px;position:relative;z-index:1;left:-5px;margin-top:5px;margin-bottom:15px;font-size:1.1rem;display:flex;align-items:center;justify-content:flex-start}.playerstats[data-v-373ce9fe]>:not(:last-of-type){margin-right:10px}.shop[data-v-373ce9fe]{margin-top:10px}.notification[data-v-373ce9fe]{position:absolute;z-index:5;top:48%;left:50%;transform:translatex(-50%) translateY(-50%);color:var(--info);background:var(--bg-overlay);padding:10px 20px;font-size:1.2em;font-weight:600;text-align:center;box-shadow:0 5px 10px var(--bg-shade3);pointer-events:none;min-width:70%}.notification-enter[data-v-373ce9fe],.notification-leave-to[data-v-373ce9fe]{opacity:0}.notification-enter-active[data-v-373ce9fe]{transition:all .1s}.notification-leave-active[data-v-373ce9fe]{transition:all .5s}",""])},186:function(e,t,n){"use strict";n.r(t);var r=n(149),o=(n(55),n(36),n(5)),c=(n(70),n(71),n(25),n(17),n(54),{props:{x:{default:0},y:{default:0},type:{},color:{default:"white"},moving:{default:!1},damage:{default:!1},indicator:{},bench:{default:!1}},data:function(){return{}},computed:{},watch:{},methods:{},mounted:function(){}}),l=(n(164),n(18)),d=Object(l.a)(c,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"piece",class:e.type+" "+(e.color||"white")+" "+(e.moving?"moving":"")+" "+(e.damage?"damage":""),style:{"grid-column":!1!==e.bench?e.bench+1+"/"+(e.bench+2):e.x+1+"/"+(e.x+2),"grid-row":!1!==e.bench?"1/2":e.y+1+"/"+(e.y+2)}},[n("div",{staticClass:"pieceicon",style:{background:"url('/autochess/pieceImages/"+(e.color.substring(0,1)+e.indicator.substring(0,1))+".svg')"}}),e._v(" "),n("div",{staticClass:"piecebg"})])},[],!1,null,"fc4c75e4",null).exports,h={components:{Piece:d},props:{x:{},y:{},type:{},color:{default:"white"},id:{},indicator:{},bench:{default:!1}},data:function(){return{dragging:!1,startY:0,startX:0,dragY:0,dragX:0,boardEl:null,benchEl:null}},computed:{},watch:{},mounted:function(){this.boardEl=this.$el.parentElement.parentElement.querySelector(".board"),this.benchEl=this.$el.parentElement.parentElement.querySelector(".bench")},methods:{startDrag:function(e){e.preventDefault(),this.dragging=!0,this.$emit("startdrag"),window.addEventListener("mouseup",this.dragEnd,{passive:!1}),window.addEventListener("mousemove",this.dragMove,{passive:!1}),window.addEventListener("touchend",this.dragEnd,{passive:!1}),window.addEventListener("touchcancel",this.dragEnd,{passive:!1}),window.addEventListener("touchmove",this.dragMove,{passive:!1}),this.startY=e.clientY||e.pageY||e.touches[0].clientY,this.startX=e.clientX||e.pageX||e.touches[0].clientX,this.dragY=0,this.dragX=0},dragMove:function(e){e.preventDefault(),this.dragY=(e.clientY||e.pageY||e.touches[0].clientY)-this.startY,this.dragX=(e.clientX||e.pageX||e.touches[0].clientX)-this.startX},dragEnd:function(e){var t=this;e.preventDefault(),this.dragging=!1,window.removeEventListener("mouseup",this.dragEnd),window.removeEventListener("mousemove",this.dragMove),window.removeEventListener("touchend",this.dragEnd),window.removeEventListener("touchcancel",this.dragEnd),window.removeEventListener("touchmove",this.dragMove),this.mouseUpListener=null,this.mouseMoveListener=null;var n=this.boardEl.getBoundingClientRect(),r=n.top,o=n.left,c=n.width,l=n.height,d=((e.clientX||e.pageX||e.changedTouches[0].clientX)-o)/c,h=((e.clientY||e.pageY||e.changedTouches[0].clientY)-r)/l;this.$emit("enddrag",{x:d,y:h,id:this.id,bench:this.bench}),this.$nextTick(function(){t.dragY=0,t.dragX=0})}}},f=(n(166),Object(l.a)(h,function(){var e=this,t=e.$createElement;return(e._self._c||t)("Piece",{staticClass:"movable",class:{dragging:e.dragging},style:{top:e.dragY+"px",left:e.dragX+"px"},attrs:{x:e.x,y:e.y,type:e.type,bench:e.bench,color:e.color,indicator:e.indicator},nativeOn:{mousedown:function(t){return e.startDrag(t)},touchstart:function(t){return e.startDrag(t)}}})},[],!1,null,"082886f6",null).exports),m=(n(69),n(35),n(37));n(148);function v(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable})),t.push.apply(t,n)}return t}var y,x,k,w,O,P,_={components:{Piece:d},props:{gameData:{},playbackPosition:{},currentEvent:{}},data:function(){return{kills:[]}},computed:{unitKillList:function(){var e=[];return this.kills.forEach(function(t){e.find(function(p){return p.id===t.piece.id})||e.push(function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?v(source,!0).forEach(function(t){Object(m.a)(e,t,source[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):v(source).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))})}return e}({kills:0},t.piece));var n=e.find(function(p){return p.id===t.piece.id});n.kills++,n.type=t.piece.type}),e.sort(function(a,b){return b.kills-a.kills})}},watch:{gameData:function(){this.kills=[]},playbackPosition:function(e,t){if(e<t)this.kills=this.kills.filter(function(t){return t.pos<=e});else{if(!this.currentEvent||!["kill","end"].includes(this.currentEvent.type))return;this.kills.push({pos:e,piece:this.currentEvent.from})}}},mounted:function(){},methods:{}},j=(n(170),Object(l.a)(_,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"stats"},[n("transition-group",{attrs:{name:"grid"}},e._l(e.unitKillList,function(t){return n("div",{key:t.id,staticClass:"listing"},[n("Piece",e._b({staticClass:"piece"},"Piece",t,!1)),e._v(" "),n("div",[e._v(e._s(t.kills)+" kill"+e._s(1===t.kills?"":"s"))])],1)}),0)],1)},[],!1,null,"e2f59a0c",null).exports);y||(y=n(172),n(173),y.initializeApp({apiKey:"AIzaSyAaSK_UoqXGYC9LjSp3UC7ekef1Jys5bvI",authDomain:"autochess-89d1d.firebaseapp.com",projectId:"autochess-89d1d"}),x=y.firestore());var D,E,S,C,Y,X,G=x.collection("stats"),M={getHighScores:(X=Object(o.a)(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(k){e.next=3;break}return e.next=3,z();case 3:return e.abrupt("return",k);case 4:case"end":return e.stop()}},e)})),function(){return X.apply(this,arguments)}),getGamesCompleted:(Y=Object(o.a)(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(w){e.next=3;break}return e.next=3,R();case 3:return e.abrupt("return",w);case 4:case"end":return e.stop()}},e)})),function(){return Y.apply(this,arguments)}),getGamesPlayed:(C=Object(o.a)(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(O){e.next=3;break}return e.next=3,R();case 3:return e.abrupt("return",O);case 4:case"end":return e.stop()}},e)})),function(){return C.apply(this,arguments)}),getLevelCounts:(S=Object(o.a)(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(P){e.next=3;break}return e.next=3,T();case 3:return e.abrupt("return",P);case 4:case"end":return e.stop()}},e)})),function(){return S.apply(this,arguments)}),gameEnd:(E=Object(o.a)(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})),function(e){return E.apply(this,arguments)}),addHighScore:function(e){var t=e.level,n=e.name;if(/(nigger|fag|spic|wetback|towelhead|nigga|fuck|shit|cunt|cock|bitch)/gi.exec(n))return alert("Nope! No names like that, please!");n||(n="No Name");k.find(function(e){return e.level<=t})&&k.length>=10&&k.pop();return k.push({level:t,name:n.substring(0,14)}),k=k.sort(function(a,b){return b.level-a.level}),G.doc("highScores").update({list:k}),k},newGame:function(){G.doc("totals").update({gamesPlayed:y.firestore.FieldValue.increment(1)})},levelRatio:(D=Object(o.a)(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(P){e.next=3;break}return e.next=3,T();case 3:if(w){e.next=6;break}return e.next=6,R();case 6:for(n=0;t<1e3;)n+=P[t]||0,t++;return e.abrupt("return",n/w);case 9:case"end":return e.stop()}},e)})),function(e){return D.apply(this,arguments)})};function R(){if(!w)return G.doc("totals").get().then(function(e){w=e.data().gamesCompleted,O=e.data().gamesPlayed})}function z(){if(!k)return G.doc("highScores").get().then(function(e){k=e.data().list})}function T(){P||G.doc("levelCounts").get().then(function(e){P=e.data()})}function I(e){return $.apply(this,arguments)}function $(){return($=Object(o.a)(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(G.doc("totals").update({gamesCompleted:y.firestore.FieldValue.increment(1)}),G.doc("levelCounts").update(Object(m.a)({},t.level,y.firestore.FieldValue.increment(1))),k){e.next=5;break}return e.next=5,z();case 5:if(n=k.find(function(e){return e.level<=t.level}),!(k.length<10||void 0!==n)){e.next=8;break}return e.abrupt("return",!0);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}var B,W,A={components:{Piece:d,MovablePiece:f,Stats:j},props:{dimensions:{type:Object,default:function(){return{x:8,y:8}}},gameData:{type:Array,default:function(){return[]}},player:{},enemy:{},gamePixelWidth:{}},data:function(){return{autoSpeed:250,currentSpeed:1,columnWidth:this.gamePixelWidth/this.player.dimensions.x,playbackPosition:-1,activePopovers:[],winner:null,auto:!0,autoInterval:null,movingId:null,damageId:null,isScrubbing:!1,draggingPiece:!1,levelRatio:100}},computed:{currentGameState:function(){if(this.gameData&&this.gameData.length)return JSON.parse(this.gameData[this.playbackPosition].gameState)},currentEvent:function(){if(this.gameData&&this.gameData.length&&this.gameData[this.playbackPosition]){var e=JSON.parse(this.gameData[this.playbackPosition].event);if(Object.keys(e).length)return e}}},watch:{winner:(B=Object(o.a)(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=parseInt,e.next=3,M.levelRatio(this.player.level);case 3:e.t1=e.sent,e.t2=100*e.t1,this.levelRatio=(0,e.t0)(e.t2);case 6:case"end":return e.stop()}},e,this)})),function(){return B.apply(this,arguments)}),gameData:function(){this.playbackPosition=-1,this.winner=null,this.auto=!0,this.movingId=null,this.damageId=null,this.currentSpeed=this.autoSpeed,this.advance()},currentEvent:function(e){if(e){if(this.movingId=null,this.damageId=null,["damage","kill","win"].includes(e.type)&&(this.movingId=e.from.id,this.damageId=e.to.id),e.attackInPlace,"move"===e.type&&(this.movingId=e.piece.id),"end"===e.type){if(this.movingId=e.from.id,this.winner)return;this.winner=e.winner,this.$emit("playbackFinished","black"===e.winner)}if("stalemate"===e.type){if(this.movingId=null,this.winner)return;this.winner="stalemate",this.$emit("playbackFinished")}}},playbackPosition:function(){this.$emit("playbackPosition",this.playbackPosition)}},methods:{advance:function(){this.gameData&&!this.winner&&(this.currentSpeed="stalemate"===JSON.parse(this.gameData[this.gameData.length-1].event).type?.6*this.autoSpeed-.6*this.autoSpeed*(this.playbackPosition/this.gameData.length*.65):this.autoSpeed+this.autoSpeed*(this.playbackPosition/this.gameData.length*.8),setTimeout(this.advance,this.currentSpeed),this.playbackPosition<this.gameData.length-1&&this.playbackPosition++)},reverse:function(){this.playbackPosition>0&&this.playbackPosition--},startPieceDrag:function(){this.draggingPiece=!0},placePiece:function(e){this.draggingPiece=!1;var t=Math.round(this.dimensions.x*e.x-.5),n=Math.round(this.dimensions.y*e.y-.5);t>this.dimensions.x-1||t<0||n>this.dimensions.y-1||n<0?this.$emit("sendToBench",e.id):!1!==e.bench?this.$emit("playFromBench",{x:t,y:n,id:e.id}):this.$emit("updatePiece",{homeX:t,homeY:n,id:e.id})},shouldShadeGridElement:function(e){if(this.dimensions.x%2==1)return e%2==1;for(var t=2*this.dimensions.x;e>t;)e-=t;return e<=this.dimensions.x?e%2==0:e%2==1}},mounted:function(){setTimeout(this.advance,this.currentSpeed)}},N=(n(176),Object(l.a)(A,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"gameview"},[n("span",{staticClass:"board outlines",style:{"grid-template-columns":"repeat("+e.dimensions.x+", "+e.columnWidth+"px)","grid-template-rows":"repeat("+e.dimensions.y+", "+e.columnWidth+"px)"}},e._l(e.dimensions.x*e.dimensions.y,function(i){return n("div",{key:"outline"+i,class:{shade:e.shouldShadeGridElement(i)}})}),0),e._v(" "),e.gameData?[n("Stats",{staticClass:"statspane",attrs:{gameData:e.gameData,playbackPosition:e.playbackPosition,currentEvent:e.currentEvent}}),e._v(" "),e.winner?n("div",{staticClass:"winbanner",class:{fade:e.isScrubbing}},[n("div",[n("h3",[e._v(e._s("black"===e.winner?"You win!":"stalemate"===e.winner?"It's a draw!":"You lost."))]),e._v(" "),e.player.hp>0?[e.player.previousWinnings.winGold?n("div",{staticClass:"sub"},[e._v("\n            You get\n            "),n("b",[e._v(e._s(e.player.previousWinnings.winGold)+" gold")]),e._v("\n            for "+e._s("black"===e.winner?"winning":"playing")+e._s(e.player.previousWinnings.interestGold?", and "+e.player.previousWinnings.interestGold+" gold as interest.":".")+"\n          ")]):e._e()]:e._e(),e._v(" "),"black"===e.winner&&e.levelRatio<100?n("div",{staticClass:"sub"},[e._v("\n          Only\n          "),n("b",[e._v(e._s(e.levelRatio)+"%")]),e._v(" of players make it this far.\n        ")]):e._e()],2),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.playbackPosition,expression:"playbackPosition"}],staticClass:"scrubber",attrs:{type:"range",min:"0",max:e.gameData.length-1},domProps:{value:e.playbackPosition},on:{mousedown:function(t){e.isScrubbing=!0},mouseup:function(t){e.isScrubbing=!1},touchstart:function(t){e.isScrubbing=!0},touchend:function(t){e.isScrubbing=!1},touchcancel:function(t){e.isScrubbing=!1},__r:function(t){e.playbackPosition=t.target.value}}}),e._v(" "),n("button",{on:{click:function(t){return e.$emit("next")}}},[e._v("\n        "+e._s(e.player.hp>0?"black"===e.winner?"Next Level":"Try Again":"See Scores")+"\n      ")])]):e._e(),e._v(" "),n("transition-group",{staticClass:"board",style:{"grid-template-columns":"repeat("+e.dimensions.x+", "+e.columnWidth+"px)","grid-template-rows":"repeat("+e.dimensions.y+", "+e.columnWidth+"px)"},attrs:{name:"grid"}},e._l(e.currentGameState,function(t,r){return n("Piece",{key:t.id,attrs:{x:t.x,y:t.y,indicator:t.indicator,type:t.type,color:t.color,id:t.id,moving:e.movingId===t.id,damage:e.damageId===t.id}})}),1),e._v(" "),e._l(e.activePopovers,function(t){return n("div",{key:t.id,staticClass:"eventpopover",style:{top:t.y*(100/e.dimensions.y)+50/e.dimensions.y+"%",left:t.x*(100/e.dimensions.x)+50/e.dimensions.x+"%"}},[e._v(e._s(t.amount))])})]:[n("span",{ref:"board",staticClass:"board",class:{dropzone:e.draggingPiece},style:{"grid-template-columns":"repeat("+e.dimensions.x+", "+e.columnWidth+"px)","grid-template-rows":"repeat("+e.dimensions.y+", "+e.columnWidth+"px)"}},[e._l(e.enemy.pieces,function(e,t){return n("Piece",{key:e.id,attrs:{x:e.x,y:e.y,indicator:e.indicator,type:e.type,color:e.color,id:e.id}})}),e._v(" "),e._l(e.player.pieces,function(t,r){return n("MovablePiece",{key:t.id,attrs:{x:t.x,y:t.y,indicator:t.indicator,type:t.type,color:t.color,id:t.id},on:{startdrag:e.startPieceDrag,enddrag:e.placePiece}})})],2)],e._v(" "),n("span",{ref:"bench",staticClass:"bench",class:{nointeract:e.gameData,dropzone:e.draggingPiece},style:{"grid-template-columns":"repeat("+this.player.dimensions.x+", "+e.columnWidth+"px)",height:e.columnWidth+"px",width:this.player.dimensions.x*e.columnWidth+"px"}},e._l(e.player.bench,function(t,r){return n("MovablePiece",{key:t.id,attrs:{indicator:t.indicator,type:t.type,color:t.color,id:t.id,bench:t.bench},on:{startdrag:e.startPieceDrag,enddrag:e.placePiece}})}),1)],2)},[],!1,null,"331ffc42",null).exports),L={components:{},props:{player:{}},data:function(){return{highScores:[]}},computed:{},created:(W=Object(o.a)(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M.getHighScores();case 2:this.highScores=e.sent;case 3:case"end":return e.stop()}},e,this)})),function(){return W.apply(this,arguments)}),methods:{}},H=(n(178),Object(l.a)(L,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"gameoverview"},[n("h2",[e._v("Game Over!")]),e._v(" "),n("div",{staticClass:"sub"},[e._v("\n    You made it to\n    "),n("b",[e._v("level "+e._s(e.player.level))]),e._v(".\n  ")]),e._v(" "),n("div",{staticClass:"sectionlabel"},[e._v("High Scores")]),e._v(" "),e._m(0),e._v(" "),e._l(e.highScores,function(t,r){return n("div",{key:r,staticClass:"score",class:{highlight:e.player.name&&e.player.name===t.name&&t.level===e.player.level}},[n("span",{staticClass:"sub"},[e._v(e._s(t.name))]),e._v(" "),n("span",{staticClass:"sub"},[e._v(e._s(t.level))])])}),e._v(" "),n("button",{on:{click:function(t){return e.$emit("newGame")}}},[e._v("Play Again")])],2)},[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"score"},[t("span",{staticClass:"sub"},[t("b",[this._v("Name")])]),this._v(" "),t("span",{staticClass:"sub"},[t("b",[this._v("Level")])])])}],!1,null,"d176d6ea",null).exports),F={props:{type:{}},data:function(){return{}},computed:{},watch:{},methods:{},mounted:function(){}},U=(n(180),Object(l.a)(F,function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"icon",class:this.type})},[],!1,null,"54c30c0f",null).exports);n(96),n(97),n(163);function J(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable})),t.push.apply(t,n)}return t}function V(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?J(source,!0).forEach(function(t){Object(m.a)(e,t,source[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):J(source).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))})}return e}function K(){return"".concat(Math.random()).substring(2)}var Q=function(e){var t=e.color,n=void 0===t?"white":t,r=e.x,o=e.y,c=e.bench,l=void 0!==c&&c;return V({},{toEssentials:function(){return{id:this.id,type:this.type,hp:this.hp,x:this.x,y:this.y,indicator:this.indicator,color:this.color,bench:this.bench}},name:function(){return this.color+" "+this.type},dealDamage:function(e){this.hp-=e},onDamage:function(e){e.damage,e.attacker}},{id:"q"+K(),x:r,y:o,bench:l,homeX:r,homeY:o,color:n,type:"queen",indicator:"q",movePriority:7,hp:1,baseHp:1,damage:1,movement:{direction:[0,1,2,3,4,5,6,7],distance:1/0},attack:{direction:[0,1,2,3,4,5,6,7],distance:1/0}})},Z={rook:function(e){var t=e.color,n=void 0===t?"white":t,r=e.x,o=e.y,c=e.bench,l=void 0!==c&&c;return V({},{toEssentials:function(){return{id:this.id,type:this.type,hp:this.hp,x:this.x,y:this.y,indicator:this.indicator,color:this.color,bench:this.bench}},name:function(){return this.color+" "+this.type},dealDamage:function(e){this.hp-=e},onDamage:function(e){e.damage,e.attacker}},{id:"r"+K(),x:r,y:o,bench:l,homeX:r,homeY:o,color:n,type:"rook",indicator:"r",movePriority:3,hp:1,baseHp:1,damage:1,movement:{direction:[0,2,4,6],distance:1/0},attack:{direction:[0,2,4,6],distance:1/0}})},bishop:function(e){var t=e.color,n=void 0===t?"white":t,r=e.x,o=e.y,c=e.bench,l=void 0!==c&&c;return V({},{toEssentials:function(){return{id:this.id,type:this.type,hp:this.hp,x:this.x,y:this.y,indicator:this.indicator,color:this.color,bench:this.bench}},name:function(){return this.color+" "+this.type},dealDamage:function(e){this.hp-=e},onDamage:function(e){e.damage,e.attacker}},{id:"b"+K(),x:r,y:o,bench:l,homeX:r,homeY:o,color:n,type:"bishop",indicator:"b",movePriority:3,hp:1,baseHp:1,damage:1,movement:{direction:[1,3,5,7],distance:1/0},attack:{direction:[1,3,5,7],distance:1/0}})},knight:function(e){var t=e.color,n=void 0===t?"white":t,r=e.x,o=e.y,c=e.bench,l=void 0!==c&&c;return V({},{toEssentials:function(){return{id:this.id,type:this.type,hp:this.hp,x:this.x,y:this.y,indicator:this.indicator,color:this.color,bench:this.bench}},name:function(){return this.color+" "+this.type},dealDamage:function(e){this.hp-=e},onDamage:function(e){e.damage,e.attacker}},{id:"n"+K(),x:r,y:o,bench:l,homeX:r,homeY:o,color:n,type:"knight",indicator:"n",movePriority:3,hp:1,baseHp:1,damage:1})},queen:Q,king:function(e){var t=e.color,n=void 0===t?"white":t,r=e.x,o=e.y,c=e.bench,l=void 0!==c&&c;return V({},{toEssentials:function(){return{id:this.id,type:this.type,hp:this.hp,x:this.x,y:this.y,indicator:this.indicator,color:this.color,bench:this.bench}},name:function(){return this.color+" "+this.type},dealDamage:function(e){this.hp-=e},onDamage:function(e){e.damage,e.attacker}},{id:"k"+K(),x:r,y:o,bench:l,homeX:r,homeY:o,color:n,type:"king",indicator:"k",movePriority:10,hp:1,baseHp:1,damage:1,movement:{direction:[0,1,2,3,4,5,6,7],distance:1},attack:{direction:[0,1,2,3,4,5,6,7],distance:1},onDamage:function(e){e.damage,e.attacker}})},pawn:function e(t){var n=t.color,r=void 0===n?"white":n,o=t.x,c=t.y,l=t.bench,d=void 0!==l&&l;return V({},{toEssentials:function(){return{id:this.id,type:this.type,hp:this.hp,x:this.x,y:this.y,indicator:this.indicator,color:this.color,bench:this.bench}},name:function(){return this.color+" "+this.type},dealDamage:function(e){this.hp-=e},onDamage:function(e){e.damage,e.attacker}},{id:"p"+K(),x:o,y:c,bench:d,homeX:o,homeY:c,color:r,type:"pawn",indicator:"p",movePriority:1,hp:1,baseHp:1,damage:1,movement:{direction:"white"===r?[4]:[0],distance:1},attack:{direction:"white"===r?[3,5]:[7,1],distance:1},onMove:function(e){var t=this,n=e.position;if(n&&(n.isTop||n.isBottom)){var r=Q({color:this.color,x:this.x,y:this.y});delete r.id,delete r.homeX,delete r.homeY,Object.keys(r).forEach(function(e){t[e]=r[e]})}},onGameReset:function(){var t=this;if("pawn"!==this.type){var n=e({color:this.color,x:this.x,y:this.y});delete n.id,delete n.homeX,delete n.homeY,Object.keys(n).forEach(function(e){t[e]=n[e]})}}})}},ee={pieces:{rook:8,bishop:7,knight:6,queen:14,king:15,pawn:3},upgrades:{hp:5}};function te(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable})),t.push.apply(t,n)}return t}function ne(e,t,n){if(e>=n.dimensions.x||e<0||t>=n.dimensions.y||t<0)return{x:e,y:t,type:null};var r=n.pieces.find(function(p){return p.x===e&&p.y===t});return r||{x:e,y:t,type:"empty"}}function ie(e,t,n,r,o,c){var l,d,h=0,f=function(){h++,l=[1,2,3].includes(r)?e+h:[5,6,7].includes(r)?e-h:e,d=[7,0,1].includes(r)?t-h:[3,4,5].includes(r)?t+h:t};f();for(var m=ne(l,d,o),v=[];h<=n&&m.type;){var y={x:l,y:d,rating:c?ae(c.color,c.type,l,d,o,e,t):null};if(!m.type){y.type="wall",v.push(y);break}if(m.color){y.type="piece",v.push(y);break}y.type="empty",v.push(y),f(),m=ne(l,d,o)}return v}function ae(e,t,n,o,c,l,d){var h,f=0,v=0,y=0,x=ne(n,o,c);x.color&&x.color===("black"===e?"white":"black")&&(h=x.type,["pawn"].includes(h)?f=.4:["rook","knight","bishop"].includes(h)?f=.5:["queen"].includes(h)?f=.6:["king"].includes(h)&&(f=100));var k=function(e,t,n,o,c,l){var d=function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?te(source,!0).forEach(function(t){Object(m.a)(e,t,source[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):te(source).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))})}return e}({},o,{pieces:[].concat(Object(r.a)(o.pieces.filter(function(p){return!(p.x===t&&p.y===n||p.x===c&&p.y===l)})),[Z.pawn({color:e,x:t,y:n})])});return d.pieces.filter(function(p){return p.color!==e&&(!!re(p,d,!1).attacks.filter(function(a){return a.toX===t&&a.toY===n}).length||void 0)})}(e,n,o,c,l,d);k.length&&(!h||ee.pieces[t]>ee.pieces[h])&&(v=.7*k.length);var w=function(e,t,n,r,o){return re(Z[t]({color:e,x:n,y:r}),o,!1).attacks}(e,t,n,o,c);return w.length&&(y=.2*w.length),{value:.5+f-v+y,rationale:{baseRating:.5,willHitBonus:f,dangerMinus:v,nextTurnBonus:y}}}function re(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("knight"===e.type)return function(e,t,n){var r=e.x,o=e.y,c=[ne(r+2,o+1,t),ne(r+2,o-1,t),ne(r+1,o+2,t),ne(r+1,o-2,t),ne(r-2,o+1,t),ne(r-2,o-1,t),ne(r-1,o+2,t),ne(r-1,o-2,t)].filter(function(e){return"empty"===e.type}).map(function(c){return{x:c.x,y:c.y,type:"move",rating:n?ae(e.color,e.type,c.x,c.y,t,r,o):null}}),l=[ne(r+2,o+1,t),ne(r+2,o-1,t),ne(r+1,o+2,t),ne(r+1,o-2,t),ne(r-2,o+1,t),ne(r-2,o-1,t),ne(r-1,o+2,t),ne(r-1,o-2,t)].filter(function(t){return t.color&&e.color!==t.color}).map(function(c){return{fromX:r,fromY:o,toX:c.x,toY:c.y,pieceToAttack:c,type:"attack",rating:n?ae(e.color,e.type,c.x,c.y,t,r,o):null}});return{moves:c,attacks:l}}(e,t,n);var r=[],o=[];return e.movement.direction.forEach(function(o){var c=ie(e.x,e.y,e.movement.distance,o,t,!!n&&e);if(c.length)for(;c.length;){var l=c.pop();"empty"===l.type&&r.push({x:l.x,y:l.y,type:"move",rating:l.rating})}}),e.attack.direction.forEach(function(r){var c=ie(e.x,e.y,e.attack.distance,r,t,!!n&&e);if(c.length){var l=c[c.length-1],d=ne(l.x,l.y,t);if(!d.color)return;if(d.color!==e.color){var h=c[c.length-2]?c[c.length-2]:e;o.push({fromX:h.x,fromY:h.y,toX:d.x,toY:d.y,pieceToAttack:d,type:"attack",rating:l.rating})}}}),{moves:r,attacks:o}}function oe(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable})),t.push.apply(t,n)}return t}function se(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?oe(source,!0).forEach(function(t){Object(m.a)(e,t,source[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):oe(source).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))})}return e}var ce=re,le=[],pe="";function ue(e){var t=e.pieces.filter(function(p){return p.hp>0});le=he(Object(r.a)(t))}function de(e,t){if(!(!e||t.gameOver||e.hp<1)){var n,o=ce(e,t,!0),c=o.moves,l=o.attacks,d=function(e){if(e&&e.length){var t,n=null;if(!(n=e.find(function(a){return a.rating.value>80}))){t=2.5*Math.random();for(var r=he(e);!n;)n=r.find(function(a){return a.rating.value>t}),t-=.2}return n||(n=e[Math.floor(Math.random()*e.length)]),n}}([].concat(Object(r.a)(l),Object(r.a)(c)));if(!d)return!1;if("attack"===d.type){if(n={type:d.pieceToAttack.hp-e.damage<=0?"kill":"damage",amount:e.damage,piece:e.toEssentials(),from:e.toEssentials(),to:d.pieceToAttack.toEssentials(),rating:d.rating},d.pieceToAttack.dealDamage(e.damage),d.pieceToAttack.onDamage&&d.pieceToAttack.onDamage({damage:e.damage,attacker:e}),d.pieceToAttack.hp<=0){var h=d.pieceToAttack.x,f=d.pieceToAttack.y;t.deletePiece(d.pieceToAttack.x,d.pieceToAttack.y),e.x=h,e.y=f}else e.x===d.fromX&&e.y===d.fromY?n.attackInPlace=!0:(e.x=d.fromX,e.y=d.fromY);d.pieceToAttack.type&&"king"===d.pieceToAttack.type&&d.pieceToAttack.hp<=0&&!t.pieces.find(function(p){return"king"===p.type&&p.color===d.pieceToAttack.color})&&(n.type="end",n.winner=e.color,t.endGame(e.color))}else"move"===d.type&&(n={type:"move",fromX:e.x,fromY:e.y,toX:d.x,toY:d.y,piece:e.toEssentials(),rating:d.rating},e.x=d.x,e.y=d.y);return!e.onMove||e.onMove({position:se({},d,{isTop:0===e.y,isBottom:e.y===t.dimensions.y-1})}),n}}function he(a){for(var i=a.length-1;i>0;i--){var e=Math.floor(Math.random()*(i+1)),t=[a[e],a[i]];a[i]=t[0],a[e]=t[1]}return a}var fe=function(e,t){var n=function(e,t){t&&(le=[],pe="");for(var n=null;!n;)if(le.length||ue(e),1===le.length&&le[0].id===pe&&ue(e),le.length){var r=le.pop();!r||r.hp<1||(r.id!==pe?(pe=r.id,n=de(r,e)):le.unshift(r))}return n}(e,t);return n||!1},me=(n(74),function(e){var t=[],n=!0,r=!1,o=void 0;try{for(var c,l=e[Symbol.iterator]();!(n=(c=l.next()).done);n=!0){var d=c.value;t.push(Z[d.type]({x:d.x,y:d.y,color:d.color||"white",bench:d.bench}))}}catch(e){r=!0,o=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw o}}return t});function ge(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable})),t.push.apply(t,n)}return t}var ve,ye=function(e){var t=e.pieces,n=void 0===t?[{type:"king",color:"black",x:3,y:7}]:t,o=e.bench,c=void 0===o?[]:o,l=e.hp,d=void 0===l?3:l,h=e.gold,f=void 0===h?0:h,v=e.isHuman,y=void 0!==v&&v,x=e.level,k=void 0===x?1:x,w=e.color,O=void 0===w?"white":w,P=e.dimensions;return{color:O,isHuman:y,level:k,hp:d,gold:f,dimensions:void 0===P?{x:8,y:8}:P,previousWinnings:{},pieces:me(n),bench:me(c),addPiece:function(e){e.color=this.color,!1!==e.bench?(e.bench=this.getOpenBenchSpot(),this.bench=[].concat(Object(r.a)(this.bench),Object(r.a)(me([e])))):this.pieces=[].concat(Object(r.a)(this.pieces),Object(r.a)(me([e])))},getOpenBenchSpot:function(e){for(var t=0;this.bench.find(function(p){return(!e||p.id!==e)&&p.bench===t});)t++;return t},toggleBench:function(e){!1!==e.bench?(e.bench=!1,this.bench=this.bench.filter(function(p){return p.id!==e.id}),this.pieces=[].concat(Object(r.a)(this.pieces),[e])):(e.bench=this.getOpenBenchSpot(e.id),this.pieces=this.pieces.filter(function(p){return p.id!==e.id}),this.bench=[].concat(Object(r.a)(this.bench),[e]))},removePiece:function(e){this.pieces=this.pieces.filter(function(p){return p.id!==e}),this.bench=this.bench.filter(function(p){return p.id!==e})},playFromBench:function(e){var t=e.id,n=e.x,r=e.y,o=this.bench.find(function(p){return p.id===t});if(!o)return{error:!0,msg:"Can't find piece to play from bench: ",context:{id:t,x:n,y:r}};if(r<this.dimensions.y/2)return{error:!0,notify:!0,msg:"Can't move a piece that far up!"};var c=this.pieces.find(function(p){return p.id!==t&&p.homeX===n&&p.homeY===r});return c&&"king"===c.type&&!this.pieces.find(function(p){return p.id!==c.id&&"king"===p.type})?{error:!0,notify:!0,msg:"Must have at least one king in play!"}:(c&&this.toggleBench(c),this.toggleBench(o),o.x=n,o.homeX=n,o.y=r,o.homeY=r,!0)},moveOnBench:function(e){e.id,e.bench,e.toX},sendToBench:function(e){var t=this.pieces.find(function(p){return p.id===e});return t?"king"!==t.type||this.pieces.find(function(p){return p.id!==e&&"king"===p.type})?(this.toggleBench(t),!0):{error:!0,notify:!0,msg:"Must have at least one king in play.",context:e}:{error:!0,msg:"Can't find piece to send to bench.",context:e}},updatePiece:function(e){var t=this.pieces.find(function(p){return p.id===e.id});if(!t)return{error:!0,msg:"Can't find piece to update.",context:e};if(e.homeY&&e.homeY<Math.floor(this.dimensions.y/2))return{error:!0,msg:"Can't move a piece that far up!",context:e,notify:!0};if(void 0!==e.homeX&&void 0!==e.homeY){var n=this.pieces.find(function(p){return p.id!==e.id&&p.homeX===e.homeX&&p.homeY===e.homeY});n&&(n.x=t.homeX,n.y=t.homeY,n.homeX=t.homeX,n.homeY=t.homeY)}return Object.keys(e).forEach(function(n){return t[n]=e[n]}),t.x=t.homeX,t.y=t.homeY,!0},applyUpgrade:function(e){"hp"===e&&this.hp++},onGameReset:function(){this.pieces.forEach(function(p){p.onGameReset&&p.onGameReset(),p.x=p.homeX,p.y=p.homeY,p.hp=p.baseHp})},levelUp:function(){this.level++},takeDamage:function(e){return!y||(this.hp-=e,this.hp>0)},addGold:function(e){var t=e?4:1,n=Math.min(5,Math.floor(this.gold/10));this.gold+=t+n,this.previousWinnings={didWin:e,winGold:t,interestGold:n}},resetPreviousGold:function(){this.previousWinnings={didWin:null,winGold:0,interestGold:0}},canBuy:function(e){return e<=this.gold},buy:function(e){return!!this.canBuy(e)&&(this.gold-=e,e)},playVs:function(e){return function(e){return{gameOver:!0,winner:null,dimensions:e.dimensions,stepCount:0,steps:[],pieces:e.pieces,deletePiece:function(e,t){this.pieces.splice(this.pieces.findIndex(function(p){return p.x===e&&p.y===t}),1)},toString:function(){return JSON.stringify(this.pieces.map(function(p){return p.toEssentials()}))},runGame:function(){var e;for(this.stepCount=0,this.gameOver=!1,this.steps.push({event:JSON.stringify({type:"start"}),gameState:this.toString()}),this.stepCount++;!this.gameOver;)if((e=fe(this,1===this.stepCount))&&(this.steps.push({event:JSON.stringify(e),gameState:this.toString()}),this.stepCount++,150===this.stepCount)){this.steps.push({event:JSON.stringify({type:"stalemate"}),gameState:this.toString()}),this.stepCount++;break}return this.steps},endGame:function(e){this.winner=e,this.gameOver=!0}}}({dimensions:this.dimensions,pieces:[].concat(Object(r.a)(e.pieces),Object(r.a)(this.pieces.map(function(p){return function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ge(source,!0).forEach(function(t){Object(m.a)(e,t,source[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):ge(source).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))})}return e}({},p,{color:"black"})})))}).runGame()}}},be={pieces:["pawn","pawn","pawn","pawn","pawn","pawn","pawn","pawn","bishop","bishop","bishop","knight","knight","knight","rook","rook","rook","queen","queen","king","king"],upgrades:["hp","hp","hp"],flatPieces:["pawn","bishop","knight","rook","queen","king"]},xe=[],ke=function(e,t){if(xe[e])return xe[e];var n=Math.ceil(t.x/2),r=[{type:"king",x:n,y:0}];e>3&&r.push({type:"pawn",x:n,y:1}),e>5&&r.push({type:"pawn",x:n-1,y:1});for(var o=4*e,c=function(){var e=be.flatPieces[Math.floor(Math.random()*be.flatPieces.length)];if(o<ee.pieces[e])return"continue";o-=ee.pieces[e];for(var n=Math.floor(Math.random()*t.x),c=Math.floor(Math.random()*Math.floor(t.y/2));r.find(function(p){return p.x===n&&p.y===c})&&r.length<32;)n=Math.floor(Math.random()*t.x),c=Math.floor(Math.random()*Math.floor(t.y/2));r.push({type:e,x:n,y:c})};o>=ee.pieces.pawn;)c();return xe[e]=r,r},we={components:{Piece:d,UpgradeIcon:U},props:{player:{},gameData:{},count:{default:4}},data:function(){return{prices:ee,totalPool:[].concat(Object(r.a)(be.pieces.map(function(p){return{name:p,type:"piece",price:ee.pieces[p]}})),Object(r.a)(be.upgrades.map(function(p){return{name:p,type:"upgrade",price:ee.upgrades[p]}}))),buyablePieces:[],notification:""}},computed:{},watch:{gameData:function(e){e||this.resetItems()}},mounted:function(){this.resetItems()},methods:{resetItems:function(){this.buyablePieces=[];for(var i=0;i<this.count;i++)this.buyablePieces.push(this.totalPool[Math.floor(Math.random()*this.totalPool.length)])},buy:function(e){e.price&&(this.player.buy(e.price)?(this.buyablePieces.splice(this.buyablePieces.findIndex(function(p){return p===e}),1),"piece"===e.type?this.player.addPiece({type:e.name,x:3,y:4,bench:!0}):"upgrade"===e.type&&this.player.applyUpgrade(e.name)):this.$emit("notify","Not enough money!"))}}},Oe=(n(182),{components:{GameView:N,GameOverView:H,Shop:Object(l.a)(we,function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.buyablePieces.length?n("div",{staticClass:"shopholder"},[n("div",{staticClass:"shop"},[n("div",{staticClass:"sectionlabel"},[e._v("Shop")]),e._v(" "),e._l(e.buyablePieces,function(t,r){return n("div",{key:t+r,staticClass:"shopitem",class:{fade:t.price>e.player.gold},on:{click:function(n){return e.buy(t)}}},["piece"===t.type?n("Piece",{staticClass:"piece",attrs:{type:t.name,color:"black",indicator:"knight"===t.name?"n":t.name.substring(0,1)}}):n("UpgradeIcon",{attrs:{type:t.name}}),e._v(" "),n("div",{staticClass:"price"},[e._v(e._s(t.price))])],1)})],2),e._v(" "),e.notification?n("div",{staticClass:"notification"},[e._v(e._s(e.notification))]):e._e()]):e._e()},[],!1,null,"de076518",null).exports,UpgradeIcon:U},data:function(){return{view:"game",gamePixelWidth:350,player:this.getNewPlayer(),enemy:{},runningGameData:null,notification:"",turn:0}},mounted:function(){this.resetEntireGame()},methods:{getNewPlayer:function(){return ye({isHuman:!0,color:"black",pieces:[{type:"king",color:"black",x:3,y:7},{type:"pawn",color:"black",x:0,y:4}],bench:[],gold:3,dimensions:{x:8,y:8}})},resetEntireGame:function(){M.newGame(),this.player=this.getNewPlayer(),this.prepareNextRound(),this.view="game"},prepareNextRound:(ve=Object(o.a)(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.player.hp<=0)){e.next=9;break}return e.next=3,M.gameEnd(this.player);case 3:if(!e.sent){e.next=7;break}t=prompt("High score! Enter your name."),this.player.name=t,M.addHighScore(this.player);case 7:return this.view="gameover",e.abrupt("return");case 9:this.runningGameData=null,this.player.onGameReset(),this.enemy=ye({pieces:ke(this.player.level,this.player.dimensions)});case 12:case"end":return e.stop()}},e,this)})),function(){return ve.apply(this,arguments)}),playbackPosition:function(e){this.turn=e},playbackFinished:function(e){this.player.resetPreviousGold(),!0===e&&this.player.levelUp(),void 0!==e&&this.player.addGold(e),!1===e&&this.player.takeDamage(1)},newGame:function(){this.runningGameData||(this.runningGameData=this.player.playVs(this.enemy))},sendToBench:function(e){var t=this.player.sendToBench(e);t.error?t.notify&&this.notify(t.msg):(this.$set(this.player,"pieces",Object(r.a)(this.player.pieces)),this.$set(this.player,"bench",Object(r.a)(this.player.bench)))},playFromBench:function(e){var t=this.player.playFromBench(e);t.error?t.notify&&this.notify(t.msg):(this.$set(this.player,"pieces",Object(r.a)(this.player.pieces)),this.$set(this.player,"bench",Object(r.a)(this.player.bench)))},updatePiece:function(e){var t=this.player.updatePiece(e);t.error?t.notify&&this.notify(t.msg):this.$set(this.player,"pieces",Object(r.a)(this.player.pieces))},notify:function(e){var t=this;this.notification=e,setTimeout(function(){return t.notification=""},2e3)}}}),Pe=(n(184),Object(l.a)(Oe,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("main",{style:{width:this.gamePixelWidth+"px"}},["game"===e.view?[n("div",{staticClass:"topbar"},[n("h2",[e._v("Level "+e._s(e.player.level))]),e._v(" "),e.runningGameData?n("div",{staticClass:"sub"},[e._v("Turn "+e._s(e.turn))]):n("button",{staticClass:"tallbutton",on:{click:e.newGame}},[e._v("Start Round")])]),e._v(" "),n("div",{staticClass:"playerstats"},[n("div",[n("UpgradeIcon",{attrs:{type:"hp"}}),e._v(" "),n("span",{staticStyle:{position:"relative",top:"-5px",left:"-5px"}},[n("b",[e._v(e._s(e.player.hp))])])],1),e._v(" "),n("div",[n("UpgradeIcon",{attrs:{type:"gold"}}),e._v(" "),n("span",{staticStyle:{position:"relative",top:"-5px",left:"-5px"}},[n("b",[e._v(e._s(e.player.gold))])])],1)]),e._v(" "),n("GameView",{attrs:{gameData:e.runningGameData,player:e.player,enemy:e.enemy,dimensions:e.player.dimensions,gamePixelWidth:e.gamePixelWidth},on:{next:e.prepareNextRound,playbackFinished:e.playbackFinished,playbackPosition:e.playbackPosition,updatePiece:e.updatePiece,sendToBench:e.sendToBench,playFromBench:e.playFromBench,notify:e.notify}}),e._v(" "),n("Shop",{staticClass:"shop",attrs:{gameData:e.runningGameData,player:e.player},on:{notify:e.notify}}),e._v(" "),n("transition",{attrs:{name:"notification"}},[e.notification?n("div",{staticClass:"notification"},[e._v(e._s(e.notification))]):e._e()])]:n("GameOverView",{attrs:{player:e.player},on:{newGame:e.resetEntireGame}})],2)},[],!1,null,"373ce9fe",null));t.default=Pe.exports}}]);