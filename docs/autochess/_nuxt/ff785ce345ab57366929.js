(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{148:function(t,e,n){"use strict";var o=n(6),r=n(155)(5),c=!0;"find"in[]&&Array(1).find(function(){c=!1}),o(o.P+o.F*c,"Array",{find:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),n(72)("find")},149:function(t,e,n){var content=n(158);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(54).default)("7b6259f4",content,!0,{sourceMap:!1})},150:function(t,e,n){var content=n(160);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(54).default)("5aaffca3",content,!0,{sourceMap:!1})},151:function(t,e,n){var content=n(164);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(54).default)("79fd60aa",content,!0,{sourceMap:!1})},152:function(t,e,n){var content=n(166);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(54).default)("061fef34",content,!0,{sourceMap:!1})},153:function(t,e,n){var content=n(168);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(54).default)("1fd40ce8",content,!0,{sourceMap:!1})},154:function(t,e,n){var content=n(170);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(54).default)("26dadc77",content,!0,{sourceMap:!1})},155:function(t,e,n){var o=n(26),r=n(73),c=n(27),l=n(19),d=n(161);t.exports=function(t,e){var n=1==t,h=2==t,f=3==t,m=4==t,y=6==t,v=5==t||y,x=e||d;return function(e,d,k){for(var w,P,O=c(e),_=r(O),D=o(d,k,3),j=l(_.length),E=0,S=n?x(e,j):h?x(e,0):void 0;j>E;E++)if((v||E in _)&&(P=D(w=_[E],E,O),t))if(n)S[E]=P;else if(P)switch(t){case 3:return!0;case 5:return w;case 6:return E;case 2:S.push(w)}else if(m)return!1;return y?-1:f||m?m:S}}},156:function(t,e,n){"use strict";var o=n(6),r=n(155)(6),c="findIndex",l=!0;c in[]&&Array(1)[c](function(){l=!1}),o(o.P+o.F*l,"Array",{findIndex:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),n(72)(c)},157:function(t,e,n){"use strict";var o=n(149);n.n(o).a},158:function(t,e,n){(t.exports=n(53)(!1)).push([t.i,".piece[data-v-59b7f34a]{position:relative;max-width:50px;z-index:1;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;transition:box-shadow .2s,transform .2s,opacity .2s,background .2s}.piece[data-v-59b7f34a],.piece div[data-v-59b7f34a]{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.piece div[data-v-59b7f34a]{background-size:contain;background-repeat:no-repeat}.piece.pawn div[data-v-59b7f34a]{opacity:.75;width:75%;height:75%}.piece.bishop div[data-v-59b7f34a],.piece.knight div[data-v-59b7f34a],.piece.rook div[data-v-59b7f34a]{width:85%;height:85%}.piece.king div[data-v-59b7f34a]{border:4px solid gold}.moving[data-v-59b7f34a]{transition:background .4s,box-shadow .4s,transform .4s,opacity .4s;transform:scale(1.3);background:hsla(0,0%,100%,.8);box-shadow:0 3px 12px rgba(0,0,0,.3);z-index:2}.moving div[data-v-59b7f34a]{opacity:1!important}.damage[data-v-59b7f34a]{transition:background .4s;background:rgba(255,0,0,.5)!important}",""])},159:function(t,e,n){"use strict";var o=n(150);n.n(o).a},160:function(t,e,n){(t.exports=n(53)(!1)).push([t.i,".movable[data-v-662f6c6c]{cursor:move}.dragging[data-v-662f6c6c],.movable[data-v-662f6c6c]{position:absolute}",""])},161:function(t,e,n){var o=n(162);t.exports=function(t,e){return new(o(t))(e)}},162:function(t,e,n){var o=n(9),r=n(95),c=n(2)("species");t.exports=function(t){var e;return r(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!r(e.prototype)||(e=void 0),o(e)&&null===(e=e[c])&&(e=void 0)),void 0===e?Array:e}},163:function(t,e,n){"use strict";var o=n(151);n.n(o).a},164:function(t,e,n){(t.exports=n(53)(!1)).push([t.i,".stats[data-v-e2f59a0c]{width:100px}.stats .listing[data-v-e2f59a0c]{display:flex;align-items:center}.stats .piece[data-v-e2f59a0c]{display:inline-block;height:30px;width:30px;margin-right:10px}.grid-move[data-v-e2f59a0c]{transition:transform .4s cubic-bezier(.175,.885,.32,1.275);z-index:2}.grid-enter-active[data-v-e2f59a0c],.grid-leave-active[data-v-e2f59a0c]{transition:all .2s cubic-bezier(.175,.885,.32,1.275)}.grid-enter[data-v-e2f59a0c],.grid-leave-to[data-v-e2f59a0c]{opacity:0;transform:translateY(10px)}",""])},165:function(t,e,n){"use strict";var o=n(152);n.n(o).a},166:function(t,e,n){(t.exports=n(53)(!1)).push([t.i,".gameview[data-v-378f1734],.gameview .board[data-v-378f1734]{position:relative}.gameview .board[data-v-378f1734]{display:grid;z-index:1;transition:background .2s;background:rgba(0,0,0,.02)}.gameview .board.dropzone[data-v-378f1734]{background:linear-gradient(180deg,hsla(0,0%,100%,.2) 50%,rgba(255,215,0,.3) 0)}.gameview .board.outlines[data-v-378f1734]{background:none;position:absolute;pointer-events:none;z-index:0;border:none}.gameview .board.outlines div[data-v-378f1734]{border:1px solid rgba(0,0,0,.02)}.gameview .board.outlines div.shade[data-v-378f1734]{background:rgba(0,0,0,.05)}.bench[data-v-378f1734]{margin-top:10px;position:relative;display:grid;z-index:1;transition:background .2s;background:rgba(0,0,0,.02)}.bench.dropzone[data-v-378f1734]{background:rgba(255,215,0,.3)}.statspane[data-v-378f1734]{position:absolute;top:0;left:110%}.nointeract[data-v-378f1734]{pointer-events:none;opacity:.6}.eventpopover[data-v-378f1734]{font-size:1.4em;font-weight:800;color:red;z-index:3;-webkit-animation-name:fadeup-data-v-378f1734;animation-name:fadeup-data-v-378f1734;-webkit-animation-duration:1s;animation-duration:1s}.eventpopover[data-v-378f1734],.winbanner[data-v-378f1734]{position:absolute;transform:translateX(-50%) translateY(-50%)}.winbanner[data-v-378f1734]{text-align:center;font-size:1.5rem;top:45%;left:50%;background:hsla(0,0%,100%,.95);padding:20px 30px;z-index:5;min-width:60%;transition:all .2s}.winbanner.fade[data-v-378f1734]{opacity:.3}.sub[data-v-378f1734]{font-size:1rem;opacity:.8}@-webkit-keyframes fadeup-data-v-378f1734{0%{transform:translateX(-50%) translateY(-50%)}to{transform:translateX(-50%) translateY(-350%);opacity:0}}@keyframes fadeup-data-v-378f1734{0%{transform:translateX(-50%) translateY(-50%)}to{transform:translateX(-50%) translateY(-350%);opacity:0}}.grid-move[data-v-378f1734]{transition:transform .4s cubic-bezier(.175,.885,.32,1.275);z-index:2}.grid-leave-active[data-v-378f1734]{display:none}",""])},167:function(t,e,n){"use strict";var o=n(153);n.n(o).a},168:function(t,e,n){(t.exports=n(53)(!1)).push([t.i,".shopholder[data-v-5b04a7f4]{position:relative}.shop[data-v-5b04a7f4]{display:flex;align-items:center}.shop[data-v-5b04a7f4]>:not(:last-child){margin-right:15px}.shop .shopitem[data-v-5b04a7f4]{flex:1;cursor:pointer;position:relative;width:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;transition:all .2s}.shop .shopitem[data-v-5b04a7f4]:hover{background:#eee}.shop .shopitem.fade[data-v-5b04a7f4]{opacity:.3}.shop .piece[data-v-5b04a7f4]{width:30px;height:30px}",""])},169:function(t,e,n){"use strict";var o=n(154);n.n(o).a},170:function(t,e,n){(t.exports=n(53)(!1)).push([t.i,"main[data-v-f881fc42]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:relative;width:300px;height:100%;margin:0 auto;flex-direction:column;justify-content:center}.topbar[data-v-f881fc42],main[data-v-f881fc42]{display:flex;align-items:center}.topbar[data-v-f881fc42]{width:100%;justify-content:space-between}.hidden[data-v-f881fc42]{opacity:0;pointer-events:none}.playerstats[data-v-f881fc42]{width:100%;margin-top:10px;margin-bottom:15px;display:flex;align-items:center;justify-content:flex-start}.playerstats[data-v-f881fc42]>:not(:last-of-type){margin-right:20px}.shop[data-v-f881fc42]{margin-top:10px}.notification[data-v-f881fc42]{position:absolute;z-index:5;top:45%;left:50%;transform:translatex(-50%) translateY(-50%);color:#8a2be2;background:hsla(0,0%,100%,.9);padding:10px 20px;font-size:1.2em;font-weight:600;text-align:center;box-shadow:0 5px 10px rgba(0,0,0,.2);pointer-events:none}.notification-enter[data-v-f881fc42],.notification-leave-to[data-v-f881fc42]{opacity:0}.notification-enter-active[data-v-f881fc42]{transition:all .1s}.notification-leave-active[data-v-f881fc42]{transition:all .5s}",""])},171:function(t,e,n){"use strict";n.r(e);function o(t){return function(t){if(Array.isArray(t)){for(var i=0,e=new Array(t.length);i<t.length;i++)e[i]=t[i];return e}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}n(70),n(71),n(25),n(17),n(52);var r={props:{x:{default:0},y:{default:0},type:{},color:{default:"white"},moving:{default:!1},damage:{default:!1},indicator:{},bench:{default:!1}},data:function(){return{}},computed:{},watch:{},methods:{},mounted:function(){}},c=(n(157),n(18)),l=Object(c.a)(r,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"piece",class:t.type+" "+(t.color||"white")+" "+(t.moving?"moving":"")+" "+(t.damage?"damage":""),style:{"grid-column":!1!==t.bench?t.bench+1+"/"+(t.bench+2):t.x+1+"/"+(t.x+2),"grid-row":!1!==t.bench?"1/2":t.y+1+"/"+(t.y+2)}},[n("div",{style:{background:"url('/autochess/pieceImages/"+(t.color.substring(0,1)+t.indicator.substring(0,1))+".svg')"}})])},[],!1,null,"59b7f34a",null).exports,d={components:{Piece:l},props:{x:{},y:{},type:{},color:{default:"white"},id:{},indicator:{},bench:{default:!1}},data:function(){return{dragging:!1,startY:0,startX:0,dragY:0,dragX:0,boardEl:null,benchEl:null}},computed:{},watch:{},mounted:function(){this.boardEl=this.$el.parentElement.parentElement.querySelector(".board"),this.benchEl=this.$el.parentElement.parentElement.querySelector(".bench")},methods:{startDrag:function(t){t.preventDefault(),this.dragging=!0,this.$emit("startdrag"),window.addEventListener("mouseup",this.dragEnd),window.addEventListener("mousemove",this.dragMove),this.startY=t.clientY,this.startX=t.clientX,this.dragY=0,this.dragX=0},dragMove:function(t){t.preventDefault(),this.dragY=t.clientY-this.startY,this.dragX=t.clientX-this.startX},dragEnd:function(t){var e=this;t.preventDefault(),this.dragging=!1,window.removeEventListener("mouseup",this.dragEnd),window.removeEventListener("mousemove",this.dragMove),this.mouseUpListener=null,this.mouseMoveListener=null;var n=this.boardEl.getBoundingClientRect(),o=n.top,r=n.left,c=n.width,l=n.height,d=(t.clientX-r)/c,h=(t.clientY-o)/l;this.$emit("enddrag",{x:d,y:h,id:this.id,bench:this.bench}),this.$nextTick(function(){e.dragY=0,e.dragX=0})}}},h=(n(159),Object(c.a)(d,function(){var t=this,e=t.$createElement;return(t._self._c||e)("Piece",{staticClass:"movable",class:{dragging:t.dragging},style:{top:t.dragY+"px",left:t.dragX+"px"},attrs:{x:t.x,y:t.y,type:t.type,bench:t.bench,color:t.color,indicator:t.indicator},nativeOn:{mousedown:function(e){return t.startDrag(e)}}})},[],!1,null,"662f6c6c",null).exports),f=(n(69),n(35),n(36));n(148);function m(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable})),e.push.apply(e,n)}return e}var y={components:{Piece:l},props:{gameData:{},playbackPosition:{},currentEvent:{}},data:function(){return{kills:[]}},computed:{unitKillList:function(){var t=[];return this.kills.forEach(function(e){t.find(function(p){return p.id===e.piece.id})||t.push(function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?m(source,!0).forEach(function(e){Object(f.a)(t,e,source[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):m(source).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))})}return t}({kills:0},e.piece));var n=t.find(function(p){return p.id===e.piece.id});n.kills++,n.type=e.piece.type}),t.sort(function(a,b){return b.kills-a.kills})}},watch:{gameData:function(){this.kills=[]},playbackPosition:function(t,e){if(t<e)this.kills=this.kills.filter(function(e){return e.pos<=t});else{if(!this.currentEvent||!["kill","end"].includes(this.currentEvent.type))return;this.kills.push({pos:t,piece:this.currentEvent.from})}}},mounted:function(){},methods:{}},v=(n(163),{components:{Piece:l,MovablePiece:h,Stats:Object(c.a)(y,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"stats"},[n("transition-group",{attrs:{name:"grid"}},t._l(t.unitKillList,function(e){return n("div",{key:e.id,staticClass:"listing"},[n("Piece",t._b({staticClass:"piece"},"Piece",e,!1)),t._v(" "),n("div",[t._v(t._s(e.kills)+" kill"+t._s(1===e.kills?"":"s"))])],1)}),0)],1)},[],!1,null,"e2f59a0c",null).exports},props:{dimensions:{type:Object,default:function(){return{x:8,y:8}}},gameData:{type:Array,default:function(){return[]}},player:{},enemy:{}},data:function(){return{autoSpeed:200,currentSpeed:200,columnWidth:50,playbackPosition:-1,activePopovers:[],winner:null,auto:!0,autoInterval:null,movingId:null,damageId:null,fadeSlider:!1,draggingPiece:!1}},computed:{currentGameState:function(){if(this.gameData&&this.gameData.length)return JSON.parse(this.gameData[this.playbackPosition].gameState)},currentEvent:function(){if(this.gameData&&this.gameData.length){var t=JSON.parse(this.gameData[this.playbackPosition].event);if(Object.keys(t).length)return t}}},watch:{gameData:function(){this.playbackPosition=-1,this.winner=null,this.auto=!0,this.movingId=null,this.damageId=null,this.currentSpeed=this.autoSpeed,this.advance()},currentEvent:function(t){var e=this;if(t){if(this.movingId=null,this.damageId=null,["damage","kill","win"].includes(t.type)&&(this.movingId=t.from.id,this.damageId=t.to.id,this.activePopovers.push({x:t.to.x,y:t.to.y,amount:t.amount,id:"".concat(Math.random()).substring(2)}),setTimeout(function(){return e.activePopovers.shift()},1e3)),t.attackInPlace&&console.log("nomove"),"move"===t.type&&(this.movingId=t.piece.id),"end"===t.type){if(this.movingId=t.from.id,this.winner)return;this.winner=t.winner,this.$emit("playbackFinished","black"===t.winner)}if("stalemate"===t.type){if(this.movingId=null,this.winner)return;this.winner="stalemate",this.$emit("playbackFinished")}}},playbackPosition:function(){this.$emit("playbackPosition",this.playbackPosition)}},methods:{advance:function(){this.gameData&&!this.winner&&(this.currentSpeed=this.autoSpeed+this.autoSpeed*(this.playbackPosition/this.gameData.length*2),setTimeout(this.advance,this.currentSpeed),this.playbackPosition<this.gameData.length-1&&this.playbackPosition++)},reverse:function(){this.playbackPosition>0&&this.playbackPosition--},startPieceDrag:function(){this.draggingPiece=!0},placePiece:function(t){this.draggingPiece=!1;var e=Math.round(this.dimensions.x*t.x-.5),n=Math.round(this.dimensions.y*t.y-.5);e>this.dimensions.x-1||e<0||n>this.dimensions.y-1||n<0?this.$emit("sendToBench",t.id):!1!==t.bench?this.$emit("playFromBench",{x:e,y:n,id:t.id}):this.$emit("updatePiece",{homeX:e,homeY:n,id:t.id})},shouldShadeGridElement:function(t){if(this.dimensions.x%2==1)return t%2==1;for(var e=2*this.dimensions.x;t>e;)t-=e;return t<=this.dimensions.x?t%2==0:t%2==1}},mounted:function(){setTimeout(this.advance,this.currentSpeed)}}),x=(n(165),Object(c.a)(v,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"gameview"},[n("span",{staticClass:"board outlines",style:{"grid-template-columns":"repeat("+t.dimensions.x+", "+t.columnWidth+"px)","grid-template-rows":"repeat("+t.dimensions.y+", "+t.columnWidth+"px)"}},t._l(t.dimensions.x*t.dimensions.y,function(i){return n("div",{key:"outline"+i,class:{shade:t.shouldShadeGridElement(i)}})}),0),t._v(" "),t.gameData?[n("Stats",{staticClass:"statspane",attrs:{gameData:t.gameData,playbackPosition:t.playbackPosition,currentEvent:t.currentEvent}}),t._v(" "),t.winner?n("div",{staticClass:"winbanner",class:{fade:t.fadeSlider}},[n("div",[n("div",[t._v(t._s("black"===t.winner?"You win!":"stalemate"===t.winner?"It's a draw!":"You lost."))]),t._v(" "),n("div",{staticClass:"sub"},[t._v("You get "+t._s(t.player.previousWinnings.winGold)+" gold for "+t._s("black"===t.winner?"winning":"playing")+t._s(t.player.previousWinnings.interestGold?", and "+t.player.previousWinnings.interestGold+" gold as interest.":"."))])]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.playbackPosition,expression:"playbackPosition"}],attrs:{type:"range",min:"0",max:t.gameData.length-1},domProps:{value:t.playbackPosition},on:{mousedown:function(e){t.fadeSlider=!0},mouseup:function(e){t.fadeSlider=!1},__r:function(e){t.playbackPosition=e.target.value}}}),t._v(" "),n("button",{on:{click:function(e){return t.$emit("next")}}},[t._v(t._s("black"===t.winner?"Next Level":"Try Again"))])]):t._e(),t._v(" "),n("transition-group",{staticClass:"board",style:{"grid-template-columns":"repeat("+t.dimensions.x+", "+t.columnWidth+"px)","grid-template-rows":"repeat("+t.dimensions.y+", "+t.columnWidth+"px)"},attrs:{name:"grid"}},t._l(t.currentGameState,function(e,o){return n("Piece",{key:e.id,attrs:{x:e.x,y:e.y,indicator:e.indicator,type:e.type,color:e.color,id:e.id,moving:t.movingId===e.id,damage:t.damageId===e.id}})}),1),t._v(" "),t._l(t.activePopovers,function(e){return n("div",{key:e.id,staticClass:"eventpopover",style:{top:e.y*(100/t.dimensions.y)+50/t.dimensions.y+"%",left:e.x*(100/t.dimensions.x)+50/t.dimensions.x+"%"}},[t._v(t._s(e.amount))])})]:[n("span",{ref:"board",staticClass:"board",class:{dropzone:t.draggingPiece},style:{"grid-template-columns":"repeat("+t.dimensions.x+", "+t.columnWidth+"px)","grid-template-rows":"repeat("+t.dimensions.y+", "+t.columnWidth+"px)"}},[t._l(t.enemy.pieces,function(t,e){return n("Piece",{key:t.id,attrs:{x:t.x,y:t.y,indicator:t.indicator,type:t.type,color:t.color,id:t.id}})}),t._v(" "),t._l(t.player.pieces,function(e,o){return n("MovablePiece",{key:e.id,attrs:{x:e.x,y:e.y,indicator:e.indicator,type:e.type,color:e.color,id:e.id,boardElement:t.$refs.board,benchElement:t.$refs.bench},on:{startdrag:t.startPieceDrag,enddrag:t.placePiece}})})],2)],t._v(" "),n("span",{ref:"bench",staticClass:"bench",class:{nointeract:t.gameData,dropzone:t.draggingPiece},style:{"grid-template-columns":"repeat("+this.player.dimensions.x+", "+t.columnWidth+"px)",height:t.columnWidth+"px",width:this.player.dimensions.x*t.columnWidth+"px"}},t._l(t.player.bench,function(e,o){return n("MovablePiece",{key:e.id,attrs:{indicator:e.indicator,type:e.type,color:e.color,id:e.id,boardElement:t.$refs.board,benchElement:t.$refs.bench,bench:e.bench},on:{startdrag:t.startPieceDrag,enddrag:t.placePiece}})}),1)],2)},[],!1,null,"378f1734",null).exports);n(96),n(97),n(156),n(55);function k(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable})),e.push.apply(e,n)}return e}function w(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?k(source,!0).forEach(function(e){Object(f.a)(t,e,source[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):k(source).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))})}return t}function P(){return"".concat(Math.random()).substring(2)}var O=function(t){var e=t.color,n=void 0===e?"white":e,o=t.x,r=t.y,c=t.bench,l=void 0!==c&&c;return w({},{toEssentials:function(){return{id:this.id,type:this.type,hp:this.hp,x:this.x,y:this.y,indicator:this.indicator,color:this.color,bench:this.bench}},name:function(){return this.color+" "+this.type},dealDamage:function(t){this.hp-=t},onDamage:function(t){t.damage,t.attacker}},{id:"q"+P(),x:o,y:r,bench:l,homeX:o,homeY:r,color:n,type:"queen",indicator:"q",movePriority:7,hp:1,baseHp:1,damage:1,movement:{direction:[0,1,2,3,4,5,6,7],distance:1/0},attack:{direction:[0,1,2,3,4,5,6,7],distance:1/0}})},_={rook:function(t){var e=t.color,n=void 0===e?"white":e,o=t.x,r=t.y,c=t.bench,l=void 0!==c&&c;return w({},{toEssentials:function(){return{id:this.id,type:this.type,hp:this.hp,x:this.x,y:this.y,indicator:this.indicator,color:this.color,bench:this.bench}},name:function(){return this.color+" "+this.type},dealDamage:function(t){this.hp-=t},onDamage:function(t){t.damage,t.attacker}},{id:"r"+P(),x:o,y:r,bench:l,homeX:o,homeY:r,color:n,type:"rook",indicator:"r",movePriority:3,hp:1,baseHp:1,damage:1,movement:{direction:[0,2,4,6],distance:1/0},attack:{direction:[0,2,4,6],distance:1/0}})},bishop:function(t){var e=t.color,n=void 0===e?"white":e,o=t.x,r=t.y,c=t.bench,l=void 0!==c&&c;return w({},{toEssentials:function(){return{id:this.id,type:this.type,hp:this.hp,x:this.x,y:this.y,indicator:this.indicator,color:this.color,bench:this.bench}},name:function(){return this.color+" "+this.type},dealDamage:function(t){this.hp-=t},onDamage:function(t){t.damage,t.attacker}},{id:"b"+P(),x:o,y:r,bench:l,homeX:o,homeY:r,color:n,type:"bishop",indicator:"b",movePriority:3,hp:1,baseHp:1,damage:1,movement:{direction:[1,3,5,7],distance:1/0},attack:{direction:[1,3,5,7],distance:1/0}})},knight:function(t){var e=t.color,n=void 0===e?"white":e,o=t.x,r=t.y,c=t.bench,l=void 0!==c&&c;return w({},{toEssentials:function(){return{id:this.id,type:this.type,hp:this.hp,x:this.x,y:this.y,indicator:this.indicator,color:this.color,bench:this.bench}},name:function(){return this.color+" "+this.type},dealDamage:function(t){this.hp-=t},onDamage:function(t){t.damage,t.attacker}},{id:"n"+P(),x:o,y:r,bench:l,homeX:o,homeY:r,color:n,type:"knight",indicator:"n",movePriority:3,hp:1,baseHp:1,damage:1})},queen:O,king:function(t){var e=t.color,n=void 0===e?"white":e,o=t.x,r=t.y,c=t.bench,l=void 0!==c&&c;return w({},{toEssentials:function(){return{id:this.id,type:this.type,hp:this.hp,x:this.x,y:this.y,indicator:this.indicator,color:this.color,bench:this.bench}},name:function(){return this.color+" "+this.type},dealDamage:function(t){this.hp-=t},onDamage:function(t){t.damage,t.attacker}},{id:"k"+P(),x:o,y:r,bench:l,homeX:o,homeY:r,color:n,type:"king",indicator:"k",movePriority:10,hp:1,baseHp:1,damage:1,movement:{direction:[0,1,2,3,4,5,6,7],distance:1},attack:{direction:[0,1,2,3,4,5,6,7],distance:1},onDamage:function(t){t.damage,t.attacker}})},pawn:function t(e){var n=e.color,o=void 0===n?"white":n,r=e.x,c=e.y,l=e.bench,d=void 0!==l&&l;return w({},{toEssentials:function(){return{id:this.id,type:this.type,hp:this.hp,x:this.x,y:this.y,indicator:this.indicator,color:this.color,bench:this.bench}},name:function(){return this.color+" "+this.type},dealDamage:function(t){this.hp-=t},onDamage:function(t){t.damage,t.attacker}},{id:"p"+P(),x:r,y:c,bench:d,homeX:r,homeY:c,color:o,type:"pawn",indicator:"p",movePriority:1,hp:1,baseHp:1,damage:1,movement:{direction:"white"===o?[4]:[0],distance:1},attack:{direction:"white"===o?[3,5]:[7,1],distance:1},onMove:function(t){var e=this,n=t.position;if(n&&(n.isTop||n.isBottom)){var o=O({color:this.color,x:this.x,y:this.y});delete o.id,delete o.homeX,delete o.homeY,Object.keys(o).forEach(function(t){e[t]=o[t]})}},onGameReset:function(){var e=this;if("pawn"!==this.type){var n=t({color:this.color,x:this.x,y:this.y});delete n.id,delete n.homeX,delete n.homeY,Object.keys(n).forEach(function(t){e[t]=n[t]})}}})}};function D(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable})),e.push.apply(e,n)}return e}function j(t,e,n){if(t>=n.dimensions.x||t<0||e>=n.dimensions.y||e<0)return{x:t,y:e,type:null};var o=n.pieces.find(function(p){return p.x===t&&p.y===e});return o||{x:t,y:e,type:"empty"}}function E(t,e,n,o,r,c){var l,d,h=0,f=function(){h++,l=[1,2,3].includes(o)?t+h:[5,6,7].includes(o)?t-h:t,d=[7,0,1].includes(o)?e-h:[3,4,5].includes(o)?e+h:e};f();for(var m=j(l,d,r),y=[];h<=n&&m.type;){var v={x:l,y:d,rating:c?S(c.color,c.type,l,d,r,t,e):null};if(!m.type){v.type="wall",y.push(v);break}if(m.color){v.type="piece",y.push(v);break}v.type="empty",y.push(v),f(),m=j(l,d,r)}return y}function S(t,e,n,r,c,l,d){var h=0,m=0,y=0,v=j(n,r,c);v.color&&v.color===("black"===t?"white":"black")&&(["pawn"].includes(v.type)?h=.4:["rook","knight","bishop"].includes(v.type)?h=.5:["queen"].includes(v.type)?h=.6:["king"].includes(v.type)&&(h=100));var x=function(t,e,n,r,c,l){var d=function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?D(source,!0).forEach(function(e){Object(f.a)(t,e,source[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):D(source).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))})}return t}({},r,{pieces:[].concat(o(r.pieces.filter(function(p){return!(p.x===e&&p.y===n||p.x===c&&p.y===l)})),[_.pawn({color:t,x:e,y:n})])});return d.pieces.filter(function(p){return p.color!==t&&(!!Y(p,d,!1).attacks.filter(function(a){return a.toX===e&&a.toY===n}).length||void 0)})}(t,n,r,c,l,d);x.length&&(m=x.length,"king"===e&&(m*=2));var k=function(t,e,n,o,r){return Y(_[e]({color:t,x:n,y:o}),r,!1).attacks}(t,e,n,r,c);return k.length&&(y=.2*k.length),{value:.3+h-m+y,rationale:{baseRating:.3,willHitBonus:h,dangerMinus:m,nextTurnBonus:y}}}function Y(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("knight"===t.type)return function(t,e,n){var o=t.x,r=t.y,c=[j(o+2,r+1,e),j(o+2,r-1,e),j(o+1,r+2,e),j(o+1,r-2,e),j(o-2,r+1,e),j(o-2,r-1,e),j(o-1,r+2,e),j(o-1,r-2,e)].filter(function(t){return"empty"===t.type}).map(function(c){return{x:c.x,y:c.y,type:"move",rating:n?S(t.color,t.type,c.x,c.y,e,o,r):null}}),l=[j(o+2,r+1,e),j(o+2,r-1,e),j(o+1,r+2,e),j(o+1,r-2,e),j(o-2,r+1,e),j(o-2,r-1,e),j(o-1,r+2,e),j(o-1,r-2,e)].filter(function(e){return e.color&&t.color!==e.color}).map(function(c){return{fromX:o,fromY:r,toX:c.x,toY:c.y,pieceToAttack:c,type:"attack",rating:n?S(t.color,t.type,c.x,c.y,e,o,r):null}});return{moves:c,attacks:l}}(t,e,n);var o=[],r=[];return t.movement.direction.forEach(function(r){var c=E(t.x,t.y,t.movement.distance,r,e,!!n&&t);if(c.length)for(;c.length;){var l=c.pop();"empty"===l.type&&o.push({x:l.x,y:l.y,type:"move",rating:l.rating})}}),t.attack.direction.forEach(function(o){var c=E(t.x,t.y,t.attack.distance,o,e,!!n&&t);if(c.length){var l=c[c.length-1],d=j(l.x,l.y,e);if(!d.color)return;if(d.color!==t.color){var h=c[c.length-2]?c[c.length-2]:t;r.push({fromX:h.x,fromY:h.y,toX:d.x,toY:d.y,pieceToAttack:d,type:"attack",rating:l.rating})}}}),{moves:o,attacks:r}}function M(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable})),e.push.apply(e,n)}return e}function X(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?M(source,!0).forEach(function(e){Object(f.a)(t,e,source[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):M(source).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))})}return t}var C=Y,G=[],T="";function A(t){G=function(a){for(var i=a.length-1;i>0;i--){var t=Math.floor(Math.random()*(i+1)),e=[a[t],a[i]];a[i]=e[0],a[t]=e[1]}return a}(o(t.pieces.filter(function(p){return p.hp>0})))}function $(t,e){if(!(!t||e.gameOver||t.hp<1)){var n=C(t,e,!0),r=n.moves,c=n.attacks;console.log(t.name(),c,r);var l,d=function(t){var e=null;if(!t||!t.length)return console.log("no action to choose!");for(var n=Math.random()+.5,o=15*t.length;!e&&o;){if(!(e=t[Math.floor(Math.random()*t.length)]).rating){console.log("no rating!",e);break}e.rating.value<n&&(e=null),n-=.05,o--}return e||(e=t[Math.floor(Math.random()*t.length)]),console.log("went with",e.rating.value,e,t.map(function(a){return X({},a,{ratingNum:a.rating.value})}),o||0),e}([].concat(o(c),o(r)));if(!d)return!1;if("attack"===d.type){if(l={type:d.pieceToAttack.hp-t.damage<=0?"kill":"damage",amount:t.damage,piece:t.toEssentials(),from:t.toEssentials(),to:d.pieceToAttack.toEssentials(),rating:d.rating},d.pieceToAttack.dealDamage(t.damage),d.pieceToAttack.onDamage&&d.pieceToAttack.onDamage({damage:t.damage,attacker:t}),d.pieceToAttack.hp<=0){var h=d.pieceToAttack.x,f=d.pieceToAttack.y;e.deletePiece(d.pieceToAttack.x,d.pieceToAttack.y),t.x=h,t.y=f}else t.x===d.fromX&&t.y===d.fromY?l.attackInPlace=!0:(t.x=d.fromX,t.y=d.fromY);d.pieceToAttack.type&&"king"===d.pieceToAttack.type&&d.pieceToAttack.hp<=0&&!e.pieces.find(function(p){return"king"===p.type&&p.color===d.pieceToAttack.color})&&(l.type="end",l.winner=t.color,e.endGame(t.color))}else"move"===d.type&&(l={type:"move",fromX:t.x,fromY:t.y,toX:d.x,toY:d.y,piece:t.toEssentials(),rating:d.rating},t.x=d.x,t.y=d.y);return!t.onMove||t.onMove({position:X({},d,{isTop:0===t.y,isBottom:t.y===e.dimensions.y-1})}),l}}var B=function(t,e){var n=function(t,e){e&&(G=[],T="");for(var n=null;!n;)if(G.length||A(t),1===G.length&&G[0].id===T&&A(t),G.length){var o=G.pop();!o||o.hp<1||(o.id!==T?(T=o.id,n=$(o,t)):G.unshift(o))}return n}(t,e);return n||!1},I=(n(74),function(t){var e=[],n=!0,o=!1,r=void 0;try{for(var c,l=t[Symbol.iterator]();!(n=(c=l.next()).done);n=!0){var d=c.value;e.push(_[d.type]({x:d.x,y:d.y,color:d.color||"white",bench:d.bench}))}}catch(t){o=!0,r=t}finally{try{n||null==l.return||l.return()}finally{if(o)throw r}}return e});function z(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable})),e.push.apply(e,n)}return e}var W=function(t){var e=t.pieces,n=void 0===e?[{type:"king",color:"black",x:3,y:7}]:e,r=t.bench,c=void 0===r?[]:r,l=t.hp,d=void 0===l?5:l,h=t.gold,m=void 0===h?2:h,y=t.isHuman,v=void 0!==y&&y,x=t.level,k=void 0===x?1:x,w=t.color,P=void 0===w?"white":w,O=t.dimensions;return{color:P,isHuman:v,level:k,hp:d,gold:m,dimensions:void 0===O?{x:8,y:8}:O,previousWinnings:{},pieces:I(n),bench:I(c),addPiece:function(t){t.color=this.color,!1!==t.bench?(t.bench=this.getOpenBenchSpot(),this.bench=[].concat(o(this.bench),o(I([t])))):this.pieces=[].concat(o(this.pieces),o(I([t])))},getOpenBenchSpot:function(t){for(var e=0;this.bench.find(function(p){return(!t||p.id!==t)&&p.bench===e});)e++;return e},toggleBench:function(t){!1!==t.bench?(t.bench=!1,this.bench=this.bench.filter(function(p){return p.id!==t.id}),this.pieces=[].concat(o(this.pieces),[t])):(t.bench=this.getOpenBenchSpot(t.id),this.pieces=this.pieces.filter(function(p){return p.id!==t.id}),this.bench=[].concat(o(this.bench),[t]))},removePiece:function(t){this.pieces=this.pieces.filter(function(p){return p.id!==t}),this.bench=this.bench.filter(function(p){return p.id!==t})},playFromBench:function(t){var e=t.id,n=t.x,o=t.y,r=this.bench.find(function(p){return p.id===e});if(!r)return{error:!0,msg:"Can't find piece to play from bench: ",context:{id:e,x:n,y:o}};if(o<this.dimensions.y/2)return{error:!0,notify:!0,msg:"Can't move a piece that far up!"};var c=this.pieces.find(function(p){return p.id!==e&&p.homeX===n&&p.homeY===o});return c&&"king"===c.type&&!this.pieces.find(function(p){return p.id!==c.id&&"king"===p.type})?{error:!0,notify:!0,msg:"Must have at least one king in play!"}:(c&&this.toggleBench(c),this.toggleBench(r),r.x=n,r.homeX=n,r.y=o,r.homeY=o,!0)},moveOnBench:function(t){t.id,t.bench,t.toX},sendToBench:function(t){var e=this.pieces.find(function(p){return p.id===t});return e?"king"!==e.type||this.pieces.find(function(p){return p.id!==t&&"king"===p.type})?(this.toggleBench(e),!0):{error:!0,notify:!0,msg:"Must have at least one king in play.",context:t}:{error:!0,msg:"Can't find piece to send to bench.",context:t}},updatePiece:function(t){var e=this.pieces.find(function(p){return p.id===t.id});if(!e)return{error:!0,msg:"Can't find piece to update.",context:t};if(t.homeY&&t.homeY<Math.floor(this.dimensions.y/2))return{error:!0,msg:"Can't move a piece that far up!",context:t,notify:!0};if(void 0!==t.homeX&&void 0!==t.homeY){var n=this.pieces.find(function(p){return p.id!==t.id&&p.homeX===t.homeX&&p.homeY===t.homeY});n&&(n.x=e.homeX,n.y=e.homeY,n.homeX=e.homeX,n.homeY=e.homeY)}return Object.keys(t).forEach(function(n){return e[n]=t[n]}),e.x=e.homeX,e.y=e.homeY,!0},onGameReset:function(){this.pieces.forEach(function(p){p.onGameReset&&p.onGameReset(),p.x=p.homeX,p.y=p.homeY,p.hp=p.baseHp})},levelUp:function(){this.level++},takeDamage:function(t){return!v||(this.hp-=t,this.hp>0)},addGold:function(t){var e=t?4:2,n=Math.min(5,Math.floor(this.gold/10));this.gold+=e+n,this.previousWinnings={didWin:t,winGold:e,interestGold:n}},canBuy:function(t){return t<=this.gold},buy:function(t){return!!this.canBuy(t)&&(this.gold-=t,t)},playVs:function(t){return function(t){return{gameOver:!0,winner:null,dimensions:t.dimensions,stepCount:0,steps:[],pieces:t.pieces,deletePiece:function(t,e){this.pieces.splice(this.pieces.findIndex(function(p){return p.x===t&&p.y===e}),1)},toString:function(){return JSON.stringify(this.pieces.map(function(p){return p.toEssentials()}))},runGame:function(){var t;for(this.stepCount=0,this.gameOver=!1,this.steps.push({event:JSON.stringify({type:"start"}),gameState:this.toString()}),this.stepCount++;!this.gameOver;)if((t=B(this,1===this.stepCount))&&(this.steps.push({event:JSON.stringify(t),gameState:this.toString()}),this.stepCount++,this.stepCount>200)){this.steps.push({event:JSON.stringify({type:"stalemate"}),gameState:this.toString()}),this.stepCount++;break}return this.steps},endGame:function(t){this.winner=t,this.gameOver=!0}}}({dimensions:this.dimensions,pieces:[].concat(o(t.pieces),o(this.pieces.map(function(p){return function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?z(source,!0).forEach(function(e){Object(f.a)(t,e,source[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):z(source).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))})}return t}({},p,{color:"black"})})))}).runGame()}}},F=["pawn","pawn","pawn","pawn","pawn","pawn","pawn","pawn","pawn","pawn","bishop","bishop","bishop","knight","knight","knight","rook","rook","rook","queen","king"],N=[],H=function(t,e){if(N[t])return N[t];var n=Math.ceil(e.x/2),o=[{type:"king",x:n,y:0}];t>3&&o.push({type:"pawn",x:n,y:1}),t>5&&o.push({type:"pawn",x:n-1,y:1});for(var r=function(i){for(var t=F[Math.floor(Math.random()*F.length)],n=Math.floor(Math.random()*e.x),r=Math.floor(Math.random()*Math.floor(e.y/2));o.find(function(p){return p.x===n&&p.y===r})&&o.length<32;)n=Math.floor(Math.random()*e.x),r=Math.floor(Math.random()*Math.floor(e.y/2));o.push({type:t,x:n,y:r})},i=1;i<t;i++)r();return N[t]=o,o},R={pieces:{rook:8,bishop:8,knight:8,queen:15,king:15,pawn:2},upgrades:{}},L={components:{Piece:l},props:{player:{},gameData:{}},data:function(){return{prices:R,buyablePieces:[],notification:""}},computed:{},watch:{gameData:function(t){t&&this.resetItems()}},mounted:function(){this.resetItems()},methods:{resetItems:function(){this.buyablePieces=[];for(var i=0;i<4;i++)this.buyablePieces=[].concat(o(this.buyablePieces),[F[Math.floor(Math.random()*F.length)]])},buy:function(t){R.pieces[t]&&(this.player.buy(R.pieces[t])?(this.buyablePieces.splice(this.buyablePieces.findIndex(function(p){return p===t}),1),this.player.addPiece({type:t,x:3,y:4,bench:!0})):this.$emit("notify","Not enough money!"))}}},J=(n(167),{components:{GameView:x,Shop:Object(c.a)(L,function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.buyablePieces.length?n("div",{staticClass:"shopholder"},[n("div",{staticClass:"shop"},[n("div",{staticClass:"sectionlabel"},[t._v("Shop")]),t._v(" "),t._l(t.buyablePieces,function(e,o){return n("div",{key:e+o,staticClass:"shopitem",class:{fade:t.prices.pieces[e]>t.player.gold},on:{click:function(n){return t.buy(e)}}},[n("Piece",{staticClass:"piece",attrs:{type:e,color:"black",indicator:"knight"===e?"n":e.substring(0,1)}}),t._v(" "),n("div",{staticClass:"price"},[t._v(t._s(t.prices.pieces[e]))])],1)})],2),t._v(" "),t.notification?n("div",{staticClass:"notification"},[t._v(t._s(t.notification))]):t._e()]):t._e()},[],!1,null,"5b04a7f4",null).exports},data:function(){return{player:W({isHuman:!0,color:"black",pieces:[{type:"king",color:"black",x:3,y:5}],bench:[{type:"pawn",color:"black",bench:0}],dimensions:{x:6,y:6}}),enemy:{},runningGameData:null,notification:"",turn:0}},mounted:function(){this.prepareNextRound()},methods:{prepareNextRound:function(){this.runningGameData=null,this.player.onGameReset(),this.enemy=W({pieces:H(this.player.level,this.player.dimensions)})},playbackPosition:function(t){this.turn=t},playbackFinished:function(t){!0===t&&this.player.levelUp(),this.player.addGold(t),!1===t&&this.player.takeDamage(1),this.player.hp<=0&&alert("game over!")},newGame:function(){this.runningGameData||(this.runningGameData=this.player.playVs(this.enemy))},sendToBench:function(t){var e=this.player.sendToBench(t);e.error?e.notify&&this.notify(e.msg):(this.$set(this.player,"pieces",o(this.player.pieces)),this.$set(this.player,"bench",o(this.player.bench)))},playFromBench:function(t){var e=this.player.playFromBench(t);e.error?e.notify&&this.notify(e.msg):(this.$set(this.player,"pieces",o(this.player.pieces)),this.$set(this.player,"bench",o(this.player.bench)))},updatePiece:function(t){var e=this.player.updatePiece(t);e.error?e.notify&&this.notify(e.msg):this.$set(this.player,"pieces",o(this.player.pieces))},notify:function(t){var e=this;this.notification=t,setTimeout(function(){return e.notification=""},2e3)}}}),V=(n(169),Object(c.a)(J,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("main",[n("div",{staticClass:"topbar"},[n("h2",[t._v("Level "+t._s(t.player.level))]),t._v(" "),n("button",{class:{hidden:t.runningGameData},on:{click:t.newGame}},[t._v("Start Round!")])]),t._v(" "),n("div",{staticClass:"playerstats"},[n("div",[t._v("Health: "+t._s(t.player.hp))]),t._v(" "),n("div",[t._v("Gold: "+t._s(t.player.gold))]),t._v(" "),t.runningGameData?n("div",[t._v("Turn: "+t._s(t.turn))]):t._e()]),t._v(" "),n("GameView",{attrs:{gameData:t.runningGameData,player:t.player,enemy:t.enemy,dimensions:t.player.dimensions},on:{next:t.prepareNextRound,playbackFinished:t.playbackFinished,playbackPosition:t.playbackPosition,updatePiece:t.updatePiece,sendToBench:t.sendToBench,playFromBench:t.playFromBench,notify:t.notify}}),t._v(" "),n("Shop",{staticClass:"shop",attrs:{gameData:t.runningGameData,player:t.player},on:{notify:t.notify}}),t._v(" "),n("transition",{attrs:{name:"notification"}},[t.notification?n("div",{staticClass:"notification"},[t._v(t._s(t.notification))]):t._e()])],1)},[],!1,null,"f881fc42",null));e.default=V.exports}}]);