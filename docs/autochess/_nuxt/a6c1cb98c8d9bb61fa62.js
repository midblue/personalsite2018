(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{148:function(e,t,n){"use strict";var o=n(6),r=n(155)(5),c=!0;"find"in[]&&Array(1).find(function(){c=!1}),o(o.P+o.F*c,"Array",{find:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),n(72)("find")},149:function(e,t,n){var content=n(158);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(53).default)("3801095b",content,!0,{sourceMap:!1})},150:function(e,t,n){var content=n(160);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(53).default)("c0d6d5ea",content,!0,{sourceMap:!1})},151:function(e,t,n){var content=n(164);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(53).default)("48a95ed3",content,!0,{sourceMap:!1})},152:function(e,t,n){var content=n(166);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(53).default)("1ef7df6c",content,!0,{sourceMap:!1})},153:function(e,t,n){var content=n(168);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(53).default)("5ebad314",content,!0,{sourceMap:!1})},154:function(e,t,n){var content=n(170);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(53).default)("01c6fed2",content,!0,{sourceMap:!1})},155:function(e,t,n){var o=n(26),r=n(73),c=n(27),d=n(19),l=n(161);e.exports=function(e,t){var n=1==e,h=2==e,f=3==e,m=4==e,v=6==e,y=5==e||v,x=t||l;return function(t,l,k){for(var w,P,O=c(t),_=r(O),D=o(l,k,3),E=d(_.length),j=0,S=n?x(t,E):h?x(t,0):void 0;E>j;j++)if((y||j in _)&&(P=D(w=_[j],j,O),e))if(n)S[j]=P;else if(P)switch(e){case 3:return!0;case 5:return w;case 6:return j;case 2:S.push(w)}else if(m)return!1;return v?-1:f||m?m:S}}},156:function(e,t,n){"use strict";var o=n(6),r=n(155)(6),c="findIndex",d=!0;c in[]&&Array(1)[c](function(){d=!1}),o(o.P+o.F*d,"Array",{findIndex:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),n(72)(c)},157:function(e,t,n){"use strict";var o=n(149);n.n(o).a},158:function(e,t,n){(e.exports=n(52)(!1)).push([e.i,".piece[data-v-2de032d0]{position:relative;max-width:50px;z-index:1;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.piece[data-v-2de032d0],.piece div[data-v-2de032d0]{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.piece div[data-v-2de032d0]{transition:box-shadow .2s,transform .2s,opacity .2s,background .2s;background-size:contain;background-repeat:no-repeat}.piece.black div[data-v-2de032d0]{background:#222;color:#fff}.piece.white div[data-v-2de032d0]{color:#222;background:#fff}.piece.pawn div[data-v-2de032d0]{opacity:.75;width:75%;height:75%}.piece.bishop div[data-v-2de032d0],.piece.knight div[data-v-2de032d0],.piece.rook div[data-v-2de032d0]{width:85%;height:85%}.piece.king div[data-v-2de032d0]{border:4px solid gold}.moving>div[data-v-2de032d0]{transition:box-shadow .4s,transform .4s,opacity .4s;opacity:1!important;transform:scale(1.3);background:hsla(0,0%,100%,.8);box-shadow:0 3px 12px rgba(0,0,0,.3)}",""])},159:function(e,t,n){"use strict";var o=n(150);n.n(o).a},160:function(e,t,n){(e.exports=n(52)(!1)).push([e.i,".movable[data-v-2469b33c]{cursor:move}.dragging[data-v-2469b33c],.movable[data-v-2469b33c]{position:absolute}",""])},161:function(e,t,n){var o=n(162);e.exports=function(e,t){return new(o(e))(t)}},162:function(e,t,n){var o=n(9),r=n(95),c=n(2)("species");e.exports=function(e){var t;return r(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!r(t.prototype)||(t=void 0),o(t)&&null===(t=t[c])&&(t=void 0)),void 0===t?Array:t}},163:function(e,t,n){"use strict";var o=n(151);n.n(o).a},164:function(e,t,n){(e.exports=n(52)(!1)).push([e.i,".stats[data-v-0e7ecd84]{width:100px}.stats .listing[data-v-0e7ecd84]{display:flex;align-items:center}.stats .piece[data-v-0e7ecd84]{display:inline-block;height:30px;width:30px;margin-right:10px}.grid-move[data-v-0e7ecd84]{transition:transform .4s cubic-bezier(.175,.885,.32,1.275);z-index:2}.grid-leave-active[data-v-0e7ecd84]{display:none}",""])},165:function(e,t,n){"use strict";var o=n(152);n.n(o).a},166:function(e,t,n){(e.exports=n(52)(!1)).push([e.i,".gameview[data-v-5749e760],.gameview .board[data-v-5749e760]{position:relative}.gameview .board[data-v-5749e760]{display:grid;z-index:1;transition:background .2s;background:rgba(0,0,0,.02)}.gameview .board.dropzone[data-v-5749e760]{background:linear-gradient(180deg,hsla(0,0%,100%,.2) 50%,rgba(255,215,0,.1) 0)}.gameview .board.outlines[data-v-5749e760]{background:none;position:absolute;pointer-events:none;z-index:0;border:none}.gameview .board.outlines div[data-v-5749e760]{border:1px solid rgba(0,0,0,.02)}.gameview .board.outlines div.shade[data-v-5749e760]{background:rgba(0,0,0,.05)}.bench[data-v-5749e760]{position:relative;display:grid;z-index:1;transition:background .2s;background:rgba(0,0,0,.02)}.bench.dropzone[data-v-5749e760]{background:rgba(255,215,0,.1)}.statspane[data-v-5749e760]{position:absolute;top:0;left:110%}.nointeract[data-v-5749e760]{pointer-events:none;opacity:.6}.eventpopover[data-v-5749e760]{font-size:1.4em;font-weight:800;color:red;z-index:3;-webkit-animation-name:fadeup-data-v-5749e760;animation-name:fadeup-data-v-5749e760;-webkit-animation-duration:1s;animation-duration:1s}.eventpopover[data-v-5749e760],.winbanner[data-v-5749e760]{position:absolute;transform:translateX(-50%) translateY(-50%)}.winbanner[data-v-5749e760]{text-align:center;font-size:1.5rem;top:50%;left:50%;background:hsla(0,0%,100%,.95);padding:20px 30px;z-index:5;min-width:60%;transition:all .2s}.winbanner.fade[data-v-5749e760]{opacity:.3}.sub[data-v-5749e760]{font-size:1rem;opacity:.8}@-webkit-keyframes fadeup-data-v-5749e760{0%{transform:translateX(-50%) translateY(-50%)}to{transform:translateX(-50%) translateY(-350%);opacity:0}}@keyframes fadeup-data-v-5749e760{0%{transform:translateX(-50%) translateY(-50%)}to{transform:translateX(-50%) translateY(-350%);opacity:0}}.grid-move[data-v-5749e760]{transition:transform .4s cubic-bezier(.175,.885,.32,1.275);z-index:2}.grid-leave-active[data-v-5749e760]{display:none}",""])},167:function(e,t,n){"use strict";var o=n(153);n.n(o).a},168:function(e,t,n){(e.exports=n(52)(!1)).push([e.i,".shopholder[data-v-61f6cadd]{position:relative}.shop[data-v-61f6cadd]{display:flex;align-items:center}.shop[data-v-61f6cadd]>:not(:last-child){margin-right:15px}.shop .shopitem[data-v-61f6cadd]{flex:1;cursor:pointer;position:relative;width:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;transition:all .2s}.shop .shopitem[data-v-61f6cadd]:hover{background:#eee}.shop .shopitem.fade[data-v-61f6cadd]{opacity:.3}.shop .piece[data-v-61f6cadd]{width:30px;height:30px}",""])},169:function(e,t,n){"use strict";var o=n(154);n.n(o).a},170:function(e,t,n){(e.exports=n(52)(!1)).push([e.i,"main[data-v-7abc4c8d]{position:relative;width:100vw;height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center}.hidden[data-v-7abc4c8d]{opacity:0;pointer-events:none}.notification[data-v-7abc4c8d]{position:absolute;z-index:5;top:40%;left:50%;transform:translatex(-50%) translateY(-50%);color:#8a2be2;background:hsla(0,0%,100%,.9);padding:10px 20px;font-size:1.2em;font-weight:600;text-align:center;box-shadow:0 5px 10px rgba(0,0,0,.2);pointer-events:none}.notification-enter[data-v-7abc4c8d],.notification-leave-to[data-v-7abc4c8d]{opacity:0}.notification-enter-active[data-v-7abc4c8d]{transition:all .1s}.notification-leave-active[data-v-7abc4c8d]{transition:all .5s}",""])},171:function(e,t,n){"use strict";n.r(t);function o(e){return function(e){if(Array.isArray(e)){for(var i=0,t=new Array(e.length);i<e.length;i++)t[i]=e[i];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}n(70),n(71),n(25),n(17),n(54);var r={props:{x:{default:0},y:{default:0},type:{},color:{default:"white"},moving:{default:!1},indicator:{},bench:{default:!1}},data:function(){return{}},computed:{},watch:{},methods:{},mounted:function(){}},c=(n(157),n(18)),d=Object(c.a)(r,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"piece",class:e.type+" "+(e.color||"white")+" "+(e.moving?"moving":""),style:{"grid-column":!1!==e.bench?e.bench+1+"/"+(e.bench+2):e.x+1+"/"+(e.x+2),"grid-row":!1!==e.bench?"1/2":e.y+1+"/"+(e.y+2)}},[n("div",{style:{background:"url('/pieceImages/"+(e.color.substring(0,1)+e.indicator.substring(0,1))+".svg')"}})])},[],!1,null,"2de032d0",null).exports,l={components:{Piece:d},props:{x:{},y:{},type:{},color:{default:"white"},id:{},indicator:{},bench:{default:!1}},data:function(){return{dragging:!1,startY:0,startX:0,dragY:0,dragX:0,boardEl:null,benchEl:null}},computed:{},watch:{},mounted:function(){this.boardEl=this.$el.parentElement.parentElement.querySelector(".board"),this.benchEl=this.$el.parentElement.parentElement.querySelector(".bench")},methods:{startDrag:function(e){this.dragging=!0,this.$emit("startdrag"),window.addEventListener("mouseup",this.dragEnd),window.addEventListener("mousemove",this.dragMove),this.startY=e.clientY,this.startX=e.clientX,this.dragY=0,this.dragX=0},dragMove:function(e){this.dragY=e.clientY-this.startY,this.dragX=e.clientX-this.startX},dragEnd:function(e){var t=this;this.dragging=!1,window.removeEventListener("mouseup",this.dragEnd),window.removeEventListener("mousemove",this.dragMove),this.mouseUpListener=null,this.mouseMoveListener=null;var n=this.boardEl.getBoundingClientRect(),o=n.top,r=n.left,c=n.width,d=n.height,l=(e.clientX-r)/c,h=(e.clientY-o)/d;this.$emit("enddrag",{x:l,y:h,id:this.id,bench:this.bench}),this.$nextTick(function(){t.dragY=0,t.dragX=0})}}},h=(n(159),Object(c.a)(l,function(){var e=this,t=e.$createElement;return(e._self._c||t)("Piece",{staticClass:"movable",class:{dragging:e.dragging},style:{top:e.dragY+"px",left:e.dragX+"px"},attrs:{x:e.x,y:e.y,type:e.type,bench:e.bench,color:e.color,indicator:e.indicator},nativeOn:{mousedown:function(t){return e.startDrag(t)}}})},[],!1,null,"2469b33c",null).exports),f=(n(69),n(35),n(36));n(148);function m(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable})),t.push.apply(t,n)}return t}var v={components:{Piece:d},props:{gameData:{},playbackPosition:{},currentEvent:{}},data:function(){return{kills:[]}},computed:{unitKillList:function(){var e=[];return this.kills.forEach(function(t){e.find(function(p){return p.id===t.piece.id})||e.push(function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?m(source,!0).forEach(function(t){Object(f.a)(e,t,source[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):m(source).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))})}return e}({kills:0},t.piece));var n=e.find(function(p){return p.id===t.piece.id});n.kills++,n.type=t.piece.type}),e.sort(function(a,b){return b.kills-a.kills})}},watch:{gameData:function(){this.kills=[]},playbackPosition:function(e,t){if(e<t)this.kills=this.kills.filter(function(t){return t.pos<=e});else{if(!this.currentEvent||!["kill","end"].includes(this.currentEvent.type))return;this.kills.push({pos:e,piece:this.currentEvent.from})}}},mounted:function(){},methods:{}},y=(n(163),{components:{Piece:d,MovablePiece:h,Stats:Object(c.a)(v,function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.unitKillList.length?n("div",{staticClass:"stats"},[n("transition-group",{attrs:{name:"grid"}},e._l(e.unitKillList,function(t){return n("div",{key:t.id,staticClass:"listing"},[n("Piece",e._b({staticClass:"piece"},"Piece",t,!1)),e._v(" "),n("span",[e._v(e._s(t.kills)+" kill"+e._s(1===t.kills?"":"s"))])],1)}),0)],1):e._e()},[],!1,null,"0e7ecd84",null).exports},props:{dimensions:{type:Object,default:function(){return{x:8,y:8}}},gameData:{type:Array,default:function(){return[]}},player:{},enemy:{}},data:function(){return{autoSpeed:200,currentSpeed:200,columnWidth:50,playbackPosition:-1,activePopovers:[],winner:null,auto:!0,autoInterval:null,movingId:null,fadeSlider:!1,draggingPiece:!1}},computed:{currentGameState:function(){if(this.gameData&&this.gameData.length)return JSON.parse(this.gameData[this.playbackPosition].gameState)},currentEvent:function(){if(this.gameData&&this.gameData.length){var e=JSON.parse(this.gameData[this.playbackPosition].event);if(Object.keys(e).length)return e}}},watch:{gameData:function(){this.playbackPosition=-1,this.winner=null,this.auto=!0,this.movingId=null,this.currentSpeed=this.autoSpeed,this.advance()},currentEvent:function(e){if(e&&(this.movingId=null,["damage","kill"].includes(e.type)&&(this.movingId=e.from.id),e.attackInPlace&&console.log("nomove"),"move"===e.type&&(this.movingId=e.piece.id),"end"===e.type)){if(this.movingId=e.from.id,this.winner)return;this.winner=e.winner,this.$emit("win","black"===e.winner)}}},methods:{advance:function(){this.gameData&&!this.winner&&(this.currentSpeed=this.autoSpeed+this.autoSpeed*(this.playbackPosition/this.gameData.length*2),setTimeout(this.advance,this.currentSpeed),this.playbackPosition<this.gameData.length-1&&this.playbackPosition++)},reverse:function(){this.playbackPosition>0&&this.playbackPosition--},startPieceDrag:function(){this.draggingPiece=!0},placePiece:function(e){this.draggingPiece=!1;var t=Math.round(this.dimensions.x*e.x-.5),n=Math.round(this.dimensions.y*e.y-.5);t>this.dimensions.x-1||t<0||n>this.dimensions.y-1||n<0?this.$emit("sendToBench",e.id):!1!==e.bench?this.$emit("playFromBench",{x:t,y:n,id:e.id}):this.$emit("updatePiece",{homeX:t,homeY:n,id:e.id})},shouldShadeGridElement:function(e){if(this.dimensions.x%2==1)return e%2==1;for(var t=2*this.dimensions.x;e>t;)e-=t;return e<=this.dimensions.x?e%2==0:e%2==1}},mounted:function(){setTimeout(this.advance,this.currentSpeed)}}),x=(n(165),Object(c.a)(y,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"gameview"},[n("span",{staticClass:"board outlines",style:{"grid-template-columns":"repeat("+e.dimensions.x+", "+e.columnWidth+"px)","grid-template-rows":"repeat("+e.dimensions.y+", "+e.columnWidth+"px)"}},e._l(e.dimensions.x*e.dimensions.y,function(i){return n("div",{key:"outline"+i,class:{shade:e.shouldShadeGridElement(i)}})}),0),e._v(" "),e.gameData?[n("Stats",{staticClass:"statspane",attrs:{gameData:e.gameData,playbackPosition:e.playbackPosition,currentEvent:e.currentEvent}}),e._v(" "),e.winner?n("div",{staticClass:"winbanner",class:{fade:e.fadeSlider}},[n("div",[n("div",[e._v(e._s("black"===e.winner?"You win!":"You lost."))]),e._v(" "),n("div",{staticClass:"sub"},[e._v("You get "+e._s(e.player.previousWinnings.winGold)+" gold for "+e._s("black"===e.winner?"winning":"playing")+e._s(e.player.previousWinnings.interestGold?", and "+e.player.previousWinnings.interestGold+" gold as interest.":"."))])]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.playbackPosition,expression:"playbackPosition"}],attrs:{type:"range",min:"0",max:e.gameData.length-1},domProps:{value:e.playbackPosition},on:{mousedown:function(t){e.fadeSlider=!0},mouseup:function(t){e.fadeSlider=!1},__r:function(t){e.playbackPosition=t.target.value}}}),e._v(" "),n("button",{on:{click:function(t){return e.$emit("done")}}},[e._v(e._s("black"===e.winner?"Next Level":"Try Again"))])]):e._e(),e._v(" "),n("transition-group",{staticClass:"board",style:{"grid-template-columns":"repeat("+e.dimensions.x+", "+e.columnWidth+"px)","grid-template-rows":"repeat("+e.dimensions.y+", "+e.columnWidth+"px)"},attrs:{name:"grid"}},e._l(e.currentGameState,function(t,o){return n("Piece",{key:t.id,attrs:{x:t.x,y:t.y,indicator:t.indicator,type:t.type,color:t.color,id:t.id,moving:e.movingId===t.id}})}),1),e._v(" "),e._l(e.activePopovers,function(t){return n("div",{key:t.id,staticClass:"eventpopover",style:{top:t.y*(100/e.dimensions.y)+50/e.dimensions.y+"%",left:t.x*(100/e.dimensions.x)+50/e.dimensions.x+"%"}},[e._v(e._s(t.amount))])})]:[n("span",{ref:"board",staticClass:"board",class:{dropzone:e.draggingPiece},style:{"grid-template-columns":"repeat("+e.dimensions.x+", "+e.columnWidth+"px)","grid-template-rows":"repeat("+e.dimensions.y+", "+e.columnWidth+"px)"}},[e._l(e.enemy.pieces,function(e,t){return n("Piece",{key:e.id,attrs:{x:e.x,y:e.y,indicator:e.indicator,type:e.type,color:e.color,id:e.id}})}),e._v(" "),e._l(e.player.pieces,function(t,o){return n("MovablePiece",{key:t.id,attrs:{x:t.x,y:t.y,indicator:t.indicator,type:t.type,color:t.color,id:t.id,boardElement:e.$refs.board,benchElement:e.$refs.bench},on:{startdrag:e.startPieceDrag,enddrag:e.placePiece}})})],2)],e._v(" "),n("br"),e._v(" "),n("span",{ref:"bench",staticClass:"bench",class:{nointeract:e.gameData,dropzone:e.draggingPiece},style:{"grid-template-columns":"repeat(8, "+e.columnWidth+"px)",height:e.columnWidth+"px",width:8*e.columnWidth+"px"}},e._l(e.player.bench,function(t,o){return n("MovablePiece",{key:t.id,attrs:{indicator:t.indicator,type:t.type,color:t.color,id:t.id,boardElement:e.$refs.board,benchElement:e.$refs.bench,bench:t.bench},on:{startdrag:e.startPieceDrag,enddrag:e.placePiece}})}),1)],2)},[],!1,null,"5749e760",null).exports);n(96),n(97),n(156);function k(e,t,n){if(e>=n.dimensions.x||e<0||t>=n.dimensions.y||t<0)return{x:e,y:t,type:null};var o=n.pieces.find(function(p){return p.x===e&&p.y===t});return o||{x:e,y:t,type:"empty"}}function w(e,t,n,o,r){var c,d,l=0,h=function(){l++,c=[1,2,3].includes(o)?e+l:[5,6,7].includes(o)?e-l:e,d=[7,0,1].includes(o)?t-l:[3,4,5].includes(o)?t+l:t};h();for(var f=k(c,d,r),m=[];l<=n&&f.type;){if(!f.type){m.push({x:c,y:d,type:"wall"});break}if(f.color){m.push({x:c,y:d,type:"piece"});break}m.push({x:c,y:d,type:"empty"}),h(),f=k(c,d,r)}return m}function P(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable})),t.push.apply(t,n)}return t}function O(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?P(source,!0).forEach(function(t){Object(f.a)(e,t,source[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):P(source).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))})}return e}var _=function(e,t){if("knight"===e.type)return function(e,t){var n=e.x,o=e.y,r=[k(n+2,o+1,t),k(n+2,o-1,t),k(n+1,o+2,t),k(n+1,o-2,t),k(n-2,o+1,t),k(n-2,o-1,t),k(n-1,o+2,t),k(n-1,o-2,t)].filter(function(e){return"empty"===e.type}).map(function(e){return{x:e.x,y:e.y,type:"move"}}),c=[k(n+2,o+1,t),k(n+2,o-1,t),k(n+1,o+2,t),k(n+1,o-2,t),k(n-2,o+1,t),k(n-2,o-1,t),k(n-1,o+2,t),k(n-1,o-2,t)].filter(function(t){return t.color&&e.color!==t.color}).map(function(e){return{fromX:n,fromY:o,toX:e.x,toY:e.y,pieceToAttack:e,type:"attack"}});return{moves:r,attacks:c}}(e,t);var n=[],o=[];return e.movement.direction.forEach(function(o){var r=w(e.x,e.y,e.movement.distance,o,t);if(r.length)for(;r.length;){var c=r.pop();"empty"===c.type&&n.push({x:c.x,y:c.y,type:"move"})}}),e.attack.direction.forEach(function(n){var r=w(e.x,e.y,e.attack.distance,n,t);if(r.length){var c=r[r.length-1],d=k(c.x,c.y,t);if(!d.color)return;if(d.color!==e.color){var l=r[r.length-2]?r[r.length-2]:e;o.push({fromX:l.x,fromY:l.y,toX:d.x,toY:d.y,pieceToAttack:d,type:"attack"})}}}),{moves:n,attacks:o}},D=[],E="";function j(e){D=function(a){for(var i=a.length-1;i>0;i--){var e=Math.floor(Math.random()*(i+1)),t=[a[e],a[i]];a[i]=t[0],a[e]=t[1]}return a}(o(e.pieces.filter(function(p){return p.hp>0}))),console.log(D.map(function(p){return p.color+" "+p.type}))}function S(e,t){if(!(!e||t.gameOver||e.hp<1)){var n,o,r=_(e,t),c=r.moves,d=r.attacks;if(d.length){if(o={type:(n=d[Math.floor(Math.random()*d.length)]).pieceToAttack.hp-e.damage<=0?"kill":"damage",amount:e.damage,piece:e.toEssentials(),from:e.toEssentials(),to:n.pieceToAttack.toEssentials()},n.pieceToAttack.dealDamage(e.damage),n.pieceToAttack.onDamage&&n.pieceToAttack.onDamage({damage:e.damage,attacker:e}),n.pieceToAttack.hp<=0){var l=n.pieceToAttack.x,h=n.pieceToAttack.y;t.deletePiece(n.pieceToAttack.x,n.pieceToAttack.y),e.x=l,e.y=h}else{if(e.x===n.fromX&&e.y===n.fromY)return o.attackInPlace=!0;e.x=n.fromX,e.y=n.fromY}n.pieceToAttack.type&&"king"===n.pieceToAttack.type&&n.pieceToAttack.hp<=0&&!t.pieces.find(function(p){return"king"===p.type&&p.color===n.pieceToAttack.color})&&(o.type="end",o.winner=e.color,t.endGame(e.color))}else{if(!c.length)return!1;n=c[Math.floor(Math.random()*c.length)],o={type:"move",fromX:e.x,fromY:e.y,toX:n.x,toY:n.y,piece:e.toEssentials()},e.x=n.x,e.y=n.y}return!e.onMove||e.onMove({position:O({},n,{isTop:0===e.y,isBottom:e.y===t.dimensions.y-1})}),o}}var Y=function(e,t){var n=function(e,t){t&&(D=[],E="");for(var n=null;!n;)if(D.length||j(e),1===D.length&&D[0].id===E&&(j(e),console.log("resetting list")),D.length){var o=D.pop();!o||o.hp<1||(o.id!==E?(E=o.id,console.log(o.color+" "+o.type),n=S(o,e)):(D.unshift(o),console.log("shifting list",D.map(function(p){return p.color+" "+p.type}))))}return n}(e,t);return n||!1},X=function(e){return{gameOver:!0,winner:null,dimensions:e.dimensions,stepCount:0,steps:[],pieces:e.pieces,deletePiece:function(e,t){this.pieces.splice(this.pieces.findIndex(function(p){return p.x===e&&p.y===t}),1)},toString:function(){return JSON.stringify(this.pieces.map(function(p){return p.toEssentials()}))},runGame:function(){var e;for(this.stepCount=0,this.gameOver=!1,this.steps.push({event:JSON.stringify({type:"start"}),gameState:this.toString()}),this.stepCount++;!this.gameOver;)(e=Y(this,1===this.stepCount))&&(this.steps.push({event:JSON.stringify(e),gameState:this.toString()}),this.stepCount++);return this.steps},endGame:function(e){this.winner=e,this.gameOver=!0}}};n(74);function M(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable})),t.push.apply(t,n)}return t}function C(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?M(source,!0).forEach(function(t){Object(f.a)(e,t,source[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):M(source).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))})}return e}function G(){return"".concat(Math.random()).substring(2)}var T=function(e){var t=e.color,n=void 0===t?"white":t,o=e.x,r=e.y,c=e.bench,d=void 0!==c&&c;return C({},{toEssentials:function(){return{id:this.id,type:this.type,hp:this.hp,x:this.x,y:this.y,indicator:this.indicator,color:this.color,bench:this.bench}},dealDamage:function(e){this.hp-=e},onDamage:function(e){e.damage,e.attacker}},{id:"q"+G(),x:o,y:r,bench:d,homeX:o,homeY:r,color:n,type:"queen",indicator:"q",movePriority:7,hp:1,baseHp:1,damage:1,movement:{direction:[0,1,2,3,4,5,6,7],distance:1/0},attack:{direction:[0,1,2,3,4,5,6,7],distance:1/0}})},A={rook:function(e){var t=e.color,n=void 0===t?"white":t,o=e.x,r=e.y,c=e.bench,d=void 0!==c&&c;return C({},{toEssentials:function(){return{id:this.id,type:this.type,hp:this.hp,x:this.x,y:this.y,indicator:this.indicator,color:this.color,bench:this.bench}},dealDamage:function(e){this.hp-=e},onDamage:function(e){e.damage,e.attacker}},{id:"r"+G(),x:o,y:r,bench:d,homeX:o,homeY:r,color:n,type:"rook",indicator:"r",movePriority:3,hp:1,baseHp:1,damage:1,movement:{direction:[0,2,4,6],distance:1/0},attack:{direction:[0,2,4,6],distance:1/0}})},bishop:function(e){var t=e.color,n=void 0===t?"white":t,o=e.x,r=e.y,c=e.bench,d=void 0!==c&&c;return C({},{toEssentials:function(){return{id:this.id,type:this.type,hp:this.hp,x:this.x,y:this.y,indicator:this.indicator,color:this.color,bench:this.bench}},dealDamage:function(e){this.hp-=e},onDamage:function(e){e.damage,e.attacker}},{id:"b"+G(),x:o,y:r,bench:d,homeX:o,homeY:r,color:n,type:"bishop",indicator:"b",movePriority:3,hp:1,baseHp:1,damage:1,movement:{direction:[1,3,5,7],distance:1/0},attack:{direction:[1,3,5,7],distance:1/0}})},knight:function(e){var t=e.color,n=void 0===t?"white":t,o=e.x,r=e.y,c=e.bench,d=void 0!==c&&c;return C({},{toEssentials:function(){return{id:this.id,type:this.type,hp:this.hp,x:this.x,y:this.y,indicator:this.indicator,color:this.color,bench:this.bench}},dealDamage:function(e){this.hp-=e},onDamage:function(e){e.damage,e.attacker}},{id:"n"+G(),x:o,y:r,bench:d,homeX:o,homeY:r,color:n,type:"knight",indicator:"n",movePriority:3,hp:1,baseHp:1,damage:1})},queen:T,king:function(e){var t=e.color,n=void 0===t?"white":t,o=e.x,r=e.y,c=e.bench,d=void 0!==c&&c;return C({},{toEssentials:function(){return{id:this.id,type:this.type,hp:this.hp,x:this.x,y:this.y,indicator:this.indicator,color:this.color,bench:this.bench}},dealDamage:function(e){this.hp-=e},onDamage:function(e){e.damage,e.attacker}},{id:"k"+G(),x:o,y:r,bench:d,homeX:o,homeY:r,color:n,type:"king",indicator:"k",movePriority:10,hp:1,baseHp:1,damage:1,run:!0,movement:{direction:[0,1,2,3,4,5,6,7],distance:1},attack:{direction:[0,1,2,3,4,5,6,7],distance:1},onDamage:function(e){e.damage,e.attacker}})},pawn:function e(t){var n=t.color,o=void 0===n?"white":n,r=t.x,c=t.y,d=t.bench,l=void 0!==d&&d;return C({},{toEssentials:function(){return{id:this.id,type:this.type,hp:this.hp,x:this.x,y:this.y,indicator:this.indicator,color:this.color,bench:this.bench}},dealDamage:function(e){this.hp-=e},onDamage:function(e){e.damage,e.attacker}},{id:"p"+G(),x:r,y:c,bench:l,homeX:r,homeY:c,color:o,type:"pawn",indicator:"p",movePriority:1,hp:1,baseHp:1,damage:1,movement:{direction:"white"===o?[4]:[0],distance:1},attack:{direction:"white"===o?[3,5]:[7,1],distance:1},onMove:function(e){var t=this,n=e.position;if(n&&(n.isTop||n.isBottom)){var o=T({color:this.color,x:this.x,y:this.y});delete o.id,delete o.homeX,delete o.homeY,Object.keys(o).forEach(function(e){t[e]=o[e]})}},onGameReset:function(){var t=this;if("pawn"!==this.type){var n=e({color:this.color,x:this.x,y:this.y});delete n.id,delete n.homeX,delete n.homeY,Object.keys(n).forEach(function(e){t[e]=n[e]})}}})}},$=function(e){var t=[],n=!0,o=!1,r=void 0;try{for(var c,d=e[Symbol.iterator]();!(n=(c=d.next()).done);n=!0){var l=c.value;t.push(A[l.type]({x:l.x,y:l.y,color:l.color||"white",bench:l.bench}))}}catch(e){o=!0,r=e}finally{try{n||null==d.return||d.return()}finally{if(o)throw r}}return t};function B(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable})),t.push.apply(t,n)}return t}function z(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?B(source,!0).forEach(function(t){Object(f.a)(e,t,source[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):B(source).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))})}return e}var I=function(e){var t=e.pieces,n=void 0===t?[{type:"king",color:"black",x:3,y:7}]:t,r=e.bench,c=void 0===r?[]:r,d=e.hp,l=void 0===d?5:d,h=e.gold,f=void 0===h?0:h,m=e.isHuman,v=void 0!==m&&m,y=e.level,x=void 0===y?1:y,k=e.color;return{color:void 0===k?"white":k,isHuman:v,level:x,hp:l,gold:f,previousWinnings:{},pieces:$(n),bench:$(c),addPiece:function(e){e.color=this.color,!1!==e.bench?(e.bench=this.getOpenBenchSpot(),this.bench=[].concat(o(this.bench),o($([e])))):this.pieces=[].concat(o(this.pieces),o($([e])))},getOpenBenchSpot:function(e){for(var t=0;this.bench.find(function(p){return(!e||p.id!==e)&&p.bench===t});)t++;return t},toggleBench:function(e){!1!==e.bench?(e.bench=!1,this.bench=this.bench.filter(function(p){return p.id!==e.id}),this.pieces=[].concat(o(this.pieces),[e])):(e.bench=this.getOpenBenchSpot(e.id),this.pieces=this.pieces.filter(function(p){return p.id!==e.id}),this.bench=[].concat(o(this.bench),[e]))},removePiece:function(e){this.pieces=this.pieces.filter(function(p){return p.id!==e}),this.bench=this.bench.filter(function(p){return p.id!==e})},playFromBench:function(e){var t=e.id,n=e.x,o=e.y,r=this.bench.find(function(p){return p.id===t});if(!r)return{error:!0,msg:"Can't find piece to play from bench: ",context:{id:t,x:n,y:o}};if(o<4)return{error:!0,msg:"Can't move a piece that far up!"};var c=this.pieces.find(function(p){return p.id!==t&&p.homeX===n&&p.homeY===o});return c&&this.toggleBench(c),this.toggleBench(r),r.x=n,r.homeX=n,r.y=o,r.homeY=o,!0},moveOnBench:function(e){e.id,e.bench,e.toX},sendToBench:function(e){var t=this.pieces.find(function(p){return p.id===e});return t?"king"!==t.type||this.pieces.find(function(p){return p.id!==e&&"king"===p.type})?(this.toggleBench(t),!0):{error:!0,msg:"Must have at least one king in play.",context:e}:{error:!0,msg:"Can't find piece to send to bench: ",context:e}},updatePiece:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=this.pieces.find(function(p){return p.id===e.id});if(!n)return{error:!0,msg:"Can't find piece to update.",context:e};if(e.homeY&&e.homeY<Math.floor(t/2))return{error:!0,msg:"Can't move a piece that far up!"};if(void 0!==e.homeX&&void 0!==e.homeY){var o=this.pieces.find(function(p){return p.id!==e.id&&p.homeX===e.homeX&&p.homeY===e.homeY});o&&(o.x=n.homeX,o.y=n.homeY,o.homeX=n.homeX,o.homeY=n.homeY)}return Object.keys(e).forEach(function(t){return n[t]=e[t]}),n.x=n.homeX,n.y=n.homeY,!0},onGameReset:function(){this.pieces.forEach(function(p){p.onGameReset&&p.onGameReset(),p.x=p.homeX,p.y=p.homeY,p.hp=p.baseHp})},levelUp:function(){this.level++},takeDamage:function(e){return!v||(this.hp-=e,this.hp>0)},addGold:function(e){var t=e?4:2,n=Math.min(5,Math.floor(this.gold/10));this.gold+=t+n,this.previousWinnings={didWin:e,winGold:t,interestGold:n}},canBuy:function(e){return e<=this.gold},buy:function(e){return!!this.canBuy(e)&&(this.gold-=e,e)},playVs:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:8,y:8},n=X({dimensions:t,pieces:[].concat(o(e.pieces),o(this.pieces.map(function(p){return z({},p,{color:"black"})})))}),r=n.runGame();return r}}},W=[],H=function(e){if(W[e])return W[e];for(var t=["pawn","pawn","pawn","pawn","pawn","pawn","pawn","pawn","pawn","pawn","bishop","bishop","bishop","knight","knight","knight","rook","rook","rook","queen","king"],n=[{type:"king",x:4,y:0}],o=function(i){for(var e=t[Math.floor(Math.random()*t.length)],o=Math.floor(8*Math.random()),r=Math.floor(4*Math.random());n.find(function(p){return p.x===o&&p.y===r})&&n.length<32;)o=Math.floor(8*Math.random()),r=Math.floor(4*Math.random());n.push({type:e,x:o,y:r})},i=1;i<e;i++)o();return W[e]=n,n},L={pieces:{rook:8,bishop:8,knight:8,queen:15,king:15,pawn:2},upgrades:{}},F={components:{Piece:d},props:{player:{},gameData:{}},data:function(){return{prices:L,buyablePieces:[],notification:""}},computed:{},watch:{gameData:function(){this.resetItems()}},mounted:function(){this.resetItems()},methods:{resetItems:function(){var e=["pawn","pawn","pawn","pawn","pawn","pawn","pawn","pawn","pawn","pawn","bishop","bishop","bishop","knight","knight","knight","rook","rook","rook","queen","king"];this.buyablePieces=[];for(var i=0;i<3;i++)this.buyablePieces=[].concat(o(this.buyablePieces),[e[Math.floor(Math.random()*e.length)]])},buy:function(e){L.pieces[e]&&(this.player.buy(L.pieces[e])?(this.buyablePieces.splice(this.buyablePieces.findIndex(function(p){return p===e}),1),this.player.addPiece({type:e,x:3,y:4,bench:!0})):this.$emit("notify","Not enough money!"))}}},N=(n(167),{components:{GameView:x,Shop:Object(c.a)(F,function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.buyablePieces.length?n("div",{staticClass:"shopholder"},[n("div",{staticClass:"shop"},[n("div",[e._v("Shop!")]),e._v(" "),e._l(e.buyablePieces,function(t,o){return n("div",{key:t+o,staticClass:"shopitem",class:{fade:e.prices.pieces[t]>e.player.gold},on:{click:function(n){return e.buy(t)}}},[n("Piece",{staticClass:"piece",attrs:{type:t,color:"black",indicator:"knight"===t?"n":t.substring(0,1)}}),e._v(" "),n("div",{staticClass:"price"},[e._v(e._s(e.prices.pieces[t]))])],1)})],2),e._v(" "),e.notification?n("div",{staticClass:"notification"},[e._v(e._s(e.notification))]):e._e()]):e._e()},[],!1,null,"61f6cadd",null).exports},data:function(){return{player:I({isHuman:!0,color:"black",pieces:[{type:"king",color:"black",x:3,y:7}],bench:[{type:"pawn",color:"black",bench:0}]}),enemy:I({pieces:H(1)}),runningGameData:null,notification:""}},methods:{done:function(){this.runningGameData=null,this.player.onGameReset(),this.enemy=I({pieces:H(this.player.level)})},win:function(e){e&&this.player.levelUp(),this.player.addGold(e),e||this.player.takeDamage(1),this.player.hp<=0&&alert("game over!")},newGame:function(){this.runningGameData=this.player.playVs(this.enemy)},sendToBench:function(e){this.player.sendToBench(e).error||(this.$set(this.player,"pieces",o(this.player.pieces)),this.$set(this.player,"bench",o(this.player.bench)))},playFromBench:function(e){var t=this.player.playFromBench(e);t.error?this.notify(t.msg):(this.$set(this.player,"pieces",o(this.player.pieces)),this.$set(this.player,"bench",o(this.player.bench)))},updatePiece:function(e){var t=this.player.updatePiece(e);t.error?this.notify(t.msg):this.$set(this.player,"pieces",o(this.player.pieces))},notify:function(e){var t=this;this.notification=e,setTimeout(function(){return t.notification=""},2e3)}}}),J=(n(169),Object(c.a)(N,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("main",[n("h2",[e._v("Level "+e._s(e.player.level))]),e._v(" "),n("button",{class:{hidden:e.runningGameData},on:{click:e.newGame}},[e._v("Start!")]),e._v(" "),n("br"),e._v(" "),n("GameView",{attrs:{gameData:e.runningGameData,player:e.player,enemy:e.enemy},on:{done:e.done,win:e.win,updatePiece:e.updatePiece,sendToBench:e.sendToBench,playFromBench:e.playFromBench,notify:e.notify}}),e._v(" "),n("br"),e._v(" "),n("Shop",{attrs:{gameData:e.runningGameData,player:e.player},on:{notify:e.notify}}),e._v(" "),n("br"),e._v(" "),n("div",[e._v("Health: "+e._s(e.player.hp))]),e._v(" "),n("div",[e._v("Gold: "+e._s(e.player.gold))]),e._v(" "),n("transition",{attrs:{name:"notification"}},[e.notification?n("div",{staticClass:"notification"},[e._v(e._s(e.notification))]):e._e()])],1)},[],!1,null,"7abc4c8d",null));t.default=J.exports}}]);